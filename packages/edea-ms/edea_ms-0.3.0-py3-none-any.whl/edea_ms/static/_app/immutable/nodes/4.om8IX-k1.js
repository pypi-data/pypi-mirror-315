var ee=s=>{throw TypeError(s)};var te=(s,t,e)=>t.has(s)||ee("Cannot "+e);var n=(s,t,e)=>(te(s,t,"read from private field"),e?e.call(s):t.get(s)),E=(s,t,e)=>t.has(s)?ee("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e);var ae=(s,t,e)=>(te(s,t,"access private method"),e);import{e as X}from"../chunks/index.DDgd0KB9.js";import{e as Z,a as f,t as g,b as K,d as _e,j as be}from"../chunks/disclose-version.R4vLOQNQ.js";import{D as z,H as B,q as w,p as H,f as $,a as q,c as m,r as v,z as Q,s as x,t as V,aj as ge,l as ye}from"../chunks/index-client.rJPuloIY.js";import{p as we,i as M}from"../chunks/props.CRPfZ7lw.js";import{g as se}from"../chunks/entry.jyiokiFF.js";import{c as u,a as G,S as ie}from"../chunks/SimpleTable.3mU2w9X0.js";import{g as ne}from"../chunks/stores.2mnWFSYF.js";import{s as Se,r as xe}from"../chunks/ProgressBar.svelte_svelte_type_style_lang.CPHjajrS.js";import"../chunks/legacy.2nIxhB3F.js";import{I as re,P as ke,T as je}from"../chunks/Icon.Dh0Pc4QJ.js";import{g as Te}from"../chunks/stores.ZetZKxl6.js";import{b as De}from"../chunks/select.CmTwkEE2.js";function J(s){z(s,s.v+1)}const ze=async({fetch:s,params:t})=>{const e=await s("/api/projects/"+t.slug).then(a=>(a.ok||X(a.status,a.statusText),a.json()));return{testruns:await s("/api/testruns/project/"+e.id).then(a=>(a.ok||X(a.status,a.statusText),a.json())),specifications:await s("/api/specifications/project/"+e.id).then(a=>(a.ok||X(a.status,a.statusText),a.json())),project:e}},ot=Object.freeze(Object.defineProperty({__proto__:null,load:ze},Symbol.toStringTag,{value:"Module"}));var Pe=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Ie=["difference","intersection","symmetricDifference","union"],oe=!1,I,p,k,O,ce;const F=class F extends Set{constructor(e){super();E(this,O);E(this,I,new Map);E(this,p,B(0));E(this,k,B(0));if(e){for(var a of e)super.add(a);n(this,k).v=super.size}oe||ae(this,O,ce).call(this)}has(e){var a=super.has(e),r=n(this,I),o=r.get(e);if(o===void 0){if(!a)return w(n(this,p)),!1;o=B(!0),r.set(e,o)}return w(o),a}add(e){return super.has(e)||(super.add(e),z(n(this,k),super.size),J(n(this,p))),this}delete(e){var a=super.delete(e),r=n(this,I),o=r.get(e);return o!==void 0&&(r.delete(e),z(o,!1)),a&&(z(n(this,k),super.size),J(n(this,p))),a}clear(){if(super.size!==0){super.clear();var e=n(this,I);for(var a of e.values())z(a,!1);e.clear(),z(n(this,k),0),J(n(this,p))}}keys(){return this.values()}values(){return w(n(this,p)),super.values()}entries(){return w(n(this,p)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return w(n(this,k))}};I=new WeakMap,p=new WeakMap,k=new WeakMap,O=new WeakSet,ce=function(){oe=!0;var e=F.prototype,a=Set.prototype;for(const r of Pe)e[r]=function(...o){return w(n(this,p)),a[r].apply(this,o)};for(const r of Ie)e[r]=function(...o){w(n(this,p));var h=a[r].apply(this,o);return new F(h)}};let Y=F;const d=we({specifications:[],selected_ids:new Y});async function Ae(s,t,e,a){const o={type:"confirm",title:"Please Confirm",body:'Are you sure you want to delete "'+t.row.name+'"',response:async h=>{h&&await e(t.row.id)}};a.trigger(o)}var Ce=g('<button class="chip variant-soft hover:variant-filled"><span><!></span> <span>Edit</span></button> <button class="chip variant-soft hover:variant-filled"><span><!></span> <span>Delete</span></button>',1);function Ee(s,t){H(t,!0);const e=ne(),a=Te();async function r(A){try{const _=new Headers;_.append("X-WebAuth-User","default");const b=await fetch("/api/specifications/"+A,{method:"DELETE",headers:_});if(b.ok){const D={message:"Specification deleted",background:"variant-filled-success"};a.trigger(D);let C=d.specifications.findIndex(N=>N.id==A);d.specifications.splice(C,1)}else{const D={message:"An error occurred: "+b.statusText,background:"variant-filled-error",timeout:5e3};a.trigger(D)}}catch(_){const b={message:"An error occurred while sending the request to the server: "+_,background:"variant-filled-error",autohide:!1};a.trigger(b)}}async function o(A){const _={type:"component",title:"Updating Specification "+t.row.name,body:"",meta:{row:t.row,method:"PUT"},component:"modalSpecificationForm",response:async b=>{if(b){let D=d.specifications.findIndex(C=>C.id==b.id);d.specifications[D]=b,e.close()}}};e.trigger(_)}var h=Ce(),S=$(h);S.__click=o;var j=m(S),l=m(j);re(l,{size:"12",src:ke}),v(j),Q(2),v(S);var c=x(S,2);c.__click=[Ae,t,r,e];var T=m(c),L=m(T);re(L,{size:"12",src:je}),v(T),Q(2),v(c),f(s,h),q()}Z(["click"]);var Me=g("<a> </a>");function Ne(s,t){H(t,!0);var e=Me(),a=m(e,!0);v(e),V(()=>{Se(e,"href",`/testrun/${t.row.id??""}`),K(a,t.row.id)}),f(s,e),q()}function Ue(s,t,e){w(t)?d.selected_ids.add(e.row.id):d.selected_ids.delete(e.row.id)}var Oe=g('<input class="checkbox" type="checkbox">'),Fe=g('<input class="checkbox" type="checkbox" disabled>');function He(s,t){var j;H(t,!0);let e=!!((j=t.row.data)!=null&&j.vega_lite),a=ge(!1);var r=_e(),o=$(r);{var h=l=>{var c=Oe();xe(c),c.__change=[Ue,a,t],De(c,()=>w(a),T=>z(a,T)),f(l,c)},S=l=>{var c=Fe();f(l,c)};M(o,l=>{e?l(h):l(S,!1)})}f(s,r),q()}Z(["change"]);function qe(s,t,e){t.trigger(e)}var Le=g('<button class="btn variant-filled">Compare Selected</button>'),Re=g('<button class="btn variant-filled" disabled>Compare Selected</button>'),We=g("<div><!> <p>Only testruns with charts can be compared for now.</p></div> <!>",1),Xe=g("<p>No testruns available.</p>"),Be=g("<p>No specification data available.</p>"),Ge=g('<div class="container mx-auto p-8 space-y-8"><h1 class="h1"> <!></h1> <section class="space-y-2"><h2 class="h2">Testruns</h2> <!></section> <hr> <section class="space-y-2"><div class="flex justify-between"><h2 class="h2">Specifications</h2> <button class="btn variant-filled">New</button></div> <!></section></div>');function nt(s,t){H(t,!0);const e=ne();d.specifications=t.data.specifications;let a=t.data.testruns;const r=[u("id","ID"),u("project_id","Project ID"),u("name","Name"),u("minimum","Minimum"),u("typical","Typical"),u("maximum","Maximum"),u("unit","Unit"),G("Actions",Ee)],o=[G("Select",He),G("ID",Ne),u("short_code","Short code"),u("dut_id","DUT ID"),u("machine_hostname","Machine Hostname"),u("user_name","Username"),u("test_name","Test Name")],h={type:"component",title:"New specification for "+t.data.project.name,body:"",meta:{project_id:t.data.project.id},component:"modalSpecificationForm",response:async i=>{i&&(d.specifications.push(i),e.close())}};ye(()=>{d.specifications});function S(){let i=Array.from(d.selected_ids.values());se(`/project/compare?id=${t.data.project.id}&testruns=${i.join()}`)}function j(i){se(`/testrun/${i.id}`)}var l=Ge(),c=m(l),T=m(c),L=x(T);{var A=i=>{var y=be();V(()=>K(y,`(${t.data.project.number??""})`)),f(i,y)};M(L,i=>{t.data.project.number&&i(A)})}v(c);var _=x(c,2),b=x(m(_),2);{var D=i=>{var y=We(),W=$(y),pe=m(W);{var me=P=>{var U=Le();U.__click=S,f(P,U)},ve=P=>{var U=Re();f(P,U)};M(pe,P=>{d.selected_ids.size>1?P(me):P(ve,!1)})}Q(2),v(W);var he=x(W,2);ie(he,{data:a,columns:o,rowsPerPage:10,selected:j}),f(i,y)},C=i=>{var y=Xe();f(i,y)};M(b,i=>{a.length>0?i(D):i(C,!1)})}v(_);var N=x(_,4),R=m(N),de=x(m(R),2);de.__click=[qe,e,h],v(R);var le=x(R,2);{var ue=i=>{ie(i,{get data(){return d.specifications},columns:r,rowsPerPage:10})},fe=i=>{var y=Be();f(i,y)};M(le,i=>{d.specifications.length>0?i(ue):i(fe,!1)})}v(N),v(l),V(()=>K(T,`${t.data.project.name??""} `)),f(s,l),q()}Z(["click"]);export{nt as component,ot as universal};
