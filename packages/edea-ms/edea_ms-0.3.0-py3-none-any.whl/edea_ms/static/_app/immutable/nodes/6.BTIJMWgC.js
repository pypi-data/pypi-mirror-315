import{e as C,f as x,a as _,t as h}from"../chunks/disclose-version.R4vLOQNQ.js";import{p as E,f as F,a as I,c as m,r as u,z as T,s as k,g as M}from"../chunks/index-client.rJPuloIY.js";import{p as O,i as D}from"../chunks/props.CRPfZ7lw.js";import{g as U}from"../chunks/entry.jyiokiFF.js";import{c as b,a as q,S as G}from"../chunks/SimpleTable.3mU2w9X0.js";import{g as z}from"../chunks/stores.2mnWFSYF.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.CPHjajrS.js";import"../chunks/legacy.2nIxhB3F.js";import{I as A,P as L,T as R}from"../chunks/Icon.Dh0Pc4QJ.js";import{g as B}from"../chunks/stores.ZetZKxl6.js";const H=async({fetch:p,params:o})=>({projects:await await(await p("/api/projects")).json()}),ce=Object.freeze(Object.defineProperty({__proto__:null,load:H},Symbol.toStringTag,{value:"Module"})),n=O({projects:[],user:void 0});var J=h('<button class="chip variant-soft hover:variant-filled"><span><!></span> <span>Edit</span></button> <button class="chip variant-soft hover:variant-filled"><span><!></span> <span>Delete</span></button>',1);function K(p,o){E(o,!0);const a=z(),c=B();async function y(e){try{const t=await fetch("/api/projects/"+e,{method:"DELETE"});if(t.ok){const r={message:"Project deleted",background:"variant-filled-success"};c.trigger(r);let i=n.projects.findIndex(S=>S.id==e);n.projects.splice(i,1)}else{const r={message:"An error occured: "+t.statusText,background:"variant-filled-error",timeout:5e3};c.trigger(r)}}catch(t){const r={message:"An error occured while sending the request to the server: "+t,background:"variant-filled-error",autohide:!1};c.trigger(r)}}async function f(e){const r={type:"confirm",title:"Please Confirm",body:'Are you sure you want to delete "'+o.row.name+'"',response:async i=>{i&&await y(o.row.id)}};a.trigger(r)}async function g(e){var r;const t={type:"component",title:"Updating "+o.row.name,body:"",meta:{row:o.row,method:"PUT",groups:(r=n.user)==null?void 0:r.groups},component:"modalProjectForm",response:async i=>{if(i){let S=n.projects.findIndex(N=>N.id==i.message.id);n.projects[S]=i.message,a.close()}}};a.trigger(t)}var l=J(),s=F(l);s.__click=g;var v=m(s),w=m(v);A(w,{size:"12",src:L}),u(v),T(2),u(s);var d=k(s,2);d.__click=f;var j=m(d),P=m(j);A(P,{size:"12",src:R}),u(j),T(2),u(d),x("keypress",s,g),x("keypress",d,f),_(p,l),I()}C(["click"]);function Q(p,o,a){o.trigger(a)}var V=h('<button class="btn bg-gradient-to-br variant-filled">New</button>'),W=h("<p>No project data available.</p>"),X=h('<div class="container mx-auto p-8 space-y-8"><section class="flex justify-between"><h1 class="h1">Projects</h1> <!></section> <!></div>');function ie(p,o){E(o,!0);const a=z();n.projects=o.data.projects;const c=M("user"),y=[b("id","ID"),b("short_code","Short Code"),b("name","Name"),b("groups","Groups"),q("Actions",K)],f={type:"component",title:"New Project",body:"",meta:{groups:c==null?void 0:c.groups},component:"modalProjectForm",response:async e=>{e&&(n.projects.push(e),a.close())}};function g(e){U(`/project/${e.id}`)}var l=X(),s=m(l),v=k(m(s),2);{var w=e=>{var t=V();t.__click=[Q,a,f],_(e,t)};D(v,e=>{c!==void 0&&e(w)})}u(s);var d=k(s,2);{var j=e=>{G(e,{get data(){return n.projects},columns:y,rowsPerPage:10,selected:g})},P=e=>{var t=W();_(e,t)};D(d,e=>{n.projects.length>0?e(j):e(P,!1)})}u(l),_(p,l),I()}C(["click"]);export{ie as component,ce as universal};
