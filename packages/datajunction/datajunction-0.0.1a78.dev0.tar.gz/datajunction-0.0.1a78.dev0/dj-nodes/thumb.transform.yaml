display_name: 'Member: Thumb'
description: ''
query: |2-

  SELECT
      account_id,
      profile_id,
      utc_ms,
      utc_date,
      IF(thumbs_value > 0, 1, NULL) AS thumb,
      IF(thumbs_value = 3, 1, 0) AS double_thumb_up,
      IF(thumbs_value = 2, 1, 0) AS thumb_up,
      IF(thumbs_value = 1, 1, 0) AS thumb_down,
      IF(thumbs_value = 0, 1, 0) AS thumb_removed,
      device_type_id,
      location_id
  FROM source.prodhive.dse.thumb_rating_f
columns: []
primary_key: []
dimension_links:
- type: join
  dimension_node: common.dimensions.xp.measure_date
  join_type: left
  join_on: ${prefix}thumb.utc_date = common.dimensions.xp.measure_date.dateint
- type: join
  dimension_node: common.dimensions.xp.allocation_day
  join_type: right
  join_on: |2

            ${prefix}thumb.account_id = common.dimensions.xp.allocation_day.account_id
            AND FLOOR(
                (NF_TO_UNIXTIME_MS(${prefix}thumb.utc_ms) - common.dimensions.xp.allocation_day.alloc_utc_ms_ts) / 86400000.0
            ) = common.dimensions.xp.allocation_day.days_since_allocation
- type: join
  dimension_node: common.dimensions.profile
  join_type: left
  join_on: ${prefix}thumb.profile_id = common.dimensions.profile.profile_id
- type: join
  dimension_node: common.dimensions.device_type
  join_type: left
  join_on: ${prefix}thumb.device_type_id = common.dimensions.device_type.device_type_id
- type: join
  dimension_node: common.dimensions.location
  join_type: left
  join_on: ${prefix}thumb.location_id = common.dimensions.location.location_id
tags: []
