display_name: 'Users: Anhl: Mylist Add'
description: ''
query: "SELECT  account_id,\n\t1 AS mylist_add_cnt,\n\tutc_q_add_sec,\n\tutc_receipt_dateint,\n\
  \tdevice_type_id,\n\tdevice_model,\n    location_id,\n    is_remind_me,\n    show_title_id\n\
  \ FROM source.prodhive.dse.playlist_add_f"
columns:
- name: is_remind_me
  attributes:
  - dimension
- name: show_title_id
  attributes:
  - dimension
primary_key: []
dimension_links:
- type: join
  dimension_node: common.dimensions.xp.measure_date
  join_type: left
  join_on: ${prefix}mylist_add.utc_receipt_dateint = common.dimensions.xp.measure_date.dateint
- type: join
  dimension_node: common.dimensions.xp.allocation_day
  join_type: right
  join_on: ${prefix}mylist_add.account_id = common.dimensions.xp.allocation_day.account_id
    AND FLOOR((NF_TO_UNIXTIME_MS(${prefix}mylist_add.utc_q_add_sec) - common.dimensions.xp.allocation_day.alloc_utc_ms_ts)
    / 86400000.0) = common.dimensions.xp.allocation_day.days_since_allocation
- type: join
  dimension_node: common.dimensions.device_type
  join_type: left
  join_on: ${prefix}mylist_add.device_type_id = common.dimensions.device_type.device_type_id
- type: join
  dimension_node: common.dimensions.device_model
  join_type: left
  join_on: ${prefix}mylist_add.device_type_id = common.dimensions.device_model.device_type_id
    AND ${prefix}mylist_add.device_model = common.dimensions.device_model.device_model_header
- type: join
  dimension_node: common.dimensions.location
  join_type: left
  join_on: ${prefix}mylist_add.location_id = common.dimensions.location.location_id
- type: join
  dimension_node: common.dimensions.account
  join_type: left
  join_on: ${prefix}mylist_add.account_id = common.dimensions.account.account_id
tags: []
