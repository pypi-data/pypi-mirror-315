display_name: audience_agg_layer_test_v2
description: ''
query: |-
  SELECT
    utc_date,
    profile_id,
    signup_country_iso_code,
    is_in_member_cnt,
    is_in_paid_member_cnt,
    paying_plan_rollup_id,
    email_reachable,
    verified_phone,
    email_category_consent_details.WatchRecommendations_allowed AS Email_WatchRecommendations_allowed,
    email_category_consent_details.WhatYouWatch_allowed AS Email_WhatYouWatch_allowed,
    push_category_consent_details.WatchRecommendations_allowed AS Push_WatchRecommendations_allowed,
    push_category_consent_details.WhatYouWatch_allowed AS Push_WhatYouWatch_allowed
  FROM
    source.prodhive.msg_dev.metron_msg_profile_sum_with_dev
  WHERE utc_date = NF_DATEINT(DJ_LOGICAL_TIMESTAMP())
columns:
- name: utc_date
  attributes:
  - dimension
  partition:
    format: yyyyMMdd
    granularity: day
    type_: temporal
- name: signup_country_iso_code
  attributes:
  - dimension
- name: is_in_member_cnt
  attributes:
  - dimension
- name: is_in_paid_member_cnt
  attributes:
  - dimension
- name: paying_plan_rollup_id
  attributes:
  - dimension
- name: email_reachable
  attributes:
  - dimension
- name: verified_phone
  attributes:
  - dimension
- name: Email_WatchRecommendations_allowed
  attributes:
  - dimension
- name: Email_WhatYouWatch_allowed
  attributes:
  - dimension
- name: Push_WatchRecommendations_allowed
  attributes:
  - dimension
- name: Push_WhatYouWatch_allowed
  attributes:
  - dimension
primary_key: []
dimension_links: []
tags: []
