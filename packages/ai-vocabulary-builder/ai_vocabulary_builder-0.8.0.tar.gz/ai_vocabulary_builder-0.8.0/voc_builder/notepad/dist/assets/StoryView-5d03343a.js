import{d as y,r as _,J as a,m as w,q as f,a as b,n as S,e as i,f as t,g,u,h as v,w as N,v as x,F as k,i as D,j as L,c as E,k as V,l as d,t as p}from"./index-4f5cb13b.js";import{L as T}from"./LearnNav-eb12f4c6.js";const J={class:"row mt-4"},M={class:"col-12"},B={class:"row mt-2"},C={class:"cols-12"},O=t("div",{class:"alert alert-info mt-2",role:"alert"}," Read stories, master vocabulary! ",-1),P={class:"d-flex align-items-center"},U=["disabled"],$=t("i",{class:"bi bi-book"},null,-1),F=t("span",{class:"ms-4"},"Use",-1),H=t("option",{value:"6"},"6",-1),I=t("option",{value:"12"},"12",-1),W=t("option",{value:"24"},"24",-1),j=[H,I,W],q=t("span",{class:"ms-2"},"Words",-1),A={key:0,class:"row mt-2"},R={class:"cols-12"},z=t("hr",{class:"mt-3"},null,-1),G=["innerHTML"],K={class:"word-cards mt-4"},Q={class:"card-body"},X={class:"card-title"},Y=["data-tippy-content"],Z={class:"card-text text-secondary"},ot=y({__name:"StoryView",setup(tt){const n=_(a.NotStarted),c=_(6),r=_(""),l=w([]);function m(){n.value=a.Doing,r.value="";const o=new EventSource(window.API_ENDPOINT+"/api/stories/?words_num="+c.value);o.addEventListener("story_partial",s=>{r.value=s.data}),o.addEventListener("story",s=>{r.value=s.data,n.value=a.Done}),o.addEventListener("words",s=>{const e=JSON.parse(s.data);l.length=0,l.push(...e)}),o.addEventListener("error",s=>{if(s.data===void 0)return;const e=JSON.parse(s.data);E.error(e.message)}),o.onerror=function(s){o.close(),n.value=a.Done}}const h=f(()=>r.value.replace(/\$(\w+)?\$/g,'<span class="word"><mark>$1</mark></span>'));return b(()=>{S(()=>{V("i.word-card-info-icon[data-tippy-content]",{delay:100})})}),(o,s)=>(d(),i("div",null,[t("div",J,[t("div",M,[g(T,{activePanel:"story"})])]),t("div",B,[t("div",C,[O,t("div",P,[t("button",{type:"button",class:"btn btn-primary",id:"write-story",onClick:m,disabled:n.value===u(a).Doing},[$,v(" Write Me a Story ")],8,U),F,N(t("select",{class:"form-select ms-2","onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e),style:{width:"100px"}},j,512),[[x,c.value]]),q])])]),n.value!==u(a).NotStarted?(d(),i("div",A,[t("div",R,[z,t("div",{id:"story",innerHTML:u(h)},null,8,G),t("div",K,[(d(!0),i(k,null,D(l,e=>(d(),i("div",{class:"card border-info mb-3 word-card",key:e.word},[t("div",Q,[t("h5",X,[v(p(e.word)+" ",1),t("i",{class:"bi bi-info-circle float-end word-card-info-icon","data-tippy-content":e.orig_text+" / "+e.translated_text},null,8,Y)]),t("p",Z,p(e.simple_definition),1)])]))),128))])])])):L("",!0)]))}});export{ot as default};
