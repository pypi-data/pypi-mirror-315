var beaker_vue;(function(){var e={82216:function(e,t,a){"use strict";a.r(t);var n=a(31601),l=a.n(n),r=a(76314),i=a.n(r),o=i()(l());o.push([e.id,"#app{margin:.5rem}.header{display:flex;align-items:center;padding-right:.4rem;gap:.2rem}.header-title{font-size:xx-large;font-weight:bolder}.stats{margin-bottom:3rem;gap:4rem}.p-datatable{border:1px solid var(--surface-border)}.stats-tables{display:flex;flex-direction:row;gap:2rem}.selection-column{text-align:center}.selection-column .p-column-header-content{justify-content:center}.expansion-column{padding:0;padding-left:.5rem;text-align:center}.context-config{white-space:pre;font-family:monospace;font-size:90%;background-color:#e1e1e1;border-radius:6px;border:1px solid #aaa;color:inherit;padding:.5rem;overflow:auto}.p-datatable .p-datatable-tbody>tr>td{vertical-align:top;padding-top:1.25rem}.p-datatable .p-datatable-tbody>tr>td.expansion-column{padding-top:1rem}tr.p-highlight{color:#000}tr.p-row-odd{background-color:#f0f0f0}tr.p-row-odd.p-highlight{background-color:#d0d0f0}tr.p-datatable-row-expansion{background-color:#ddd}",""]),t["default"]=o},90719:function(e,t,a){"use strict";var n=a(45130),l=a(99119),r=a(56768),i=a(90144),o=a(24232),s=a(47997),d=a(799),u=a(42775),c=a(66846),f=a(44371),p=a(86659),b=a(3598),v=a(40141),h=a(42151);const k={id:"admin"},m=(0,r.Lk)("h1",{style:{"text-align":"center"}},"Beaker admin",-1),g={style:{"margin-right":"3rem",display:"flex","justify-content":"right","justify-items":"center"}},y={style:{"margin-top":"auto","margin-bottom":"auto","font-weight":"bolder","font-size":"larger"}},_={class:"stats"},F=(0,r.Lk)("h2",null,"Stats",-1),R={class:"stats-tables"},A=(0,r.Lk)("div",{class:"header"},[(0,r.Lk)("span",{class:"header-title"},"File Handles")],-1),L=(0,r.Lk)("div",{class:"header"},[(0,r.Lk)("span",{class:"header-title"},"Load")],-1),x=(0,r.Lk)("div",{class:"header"},[(0,r.Lk)("span",{class:"header-title"},"Memory")],-1),w=(0,r.Lk)("div",{class:"header"},[(0,r.Lk)("span",{class:"header-title"},"Disk")],-1),C=(0,r.Lk)("h2",null,"Sessions",-1),U={class:"header"},j=(0,r.Lk)("span",{class:"header-title"},"Sessions",-1),E=(0,r.Lk)("span",{style:{flex:"100"}},null,-1),M={style:{"font-size":"large"}},O=(0,r.Lk)("span",{style:{padding:"0 1rem"}}," | ",-1),S=(0,r.Lk)("br",null,null,-1),T=(0,r.Lk)("span",{style:{"font-weight":"bold"}},"Kernel ID:",-1),K=(0,r.Lk)("br",null,null,-1),P=(0,r.Lk)("span",{style:{"font-weight":"bold"}},"Type:",-1),D=(0,r.Lk)("br",null,null,-1),I=(0,r.Lk)("span",{style:{"font-weight":"bold"}},"Config:",-1),z=(0,r.Lk)("br",null,null,-1),W={class:"context-config"},B=(0,r.Lk)("h4",null,[(0,r.eW)("Process details "),(0,r.Lk)("span",{style:{"font-size":"smaller","margin-left":"3rem"}},"(Note: CPU and Memory usage may be reflected mulitple times due to parent/child relational reporting)")],-1);var $=(0,r.pM)({__name:"BeakerAdmin",props:["config"],setup(e){const t=(0,v.S)(),a=(0,h.d)(),n=s.PageConfig.getBaseUrl(),l=(0,i.KR)({}),$=(0,i.KR)(),X=(0,i.KR)("never"),Q=(0,i.KR)("---"),V=(0,i.KR)([]),q=(0,i.KR)([]),G=(0,r.EW)((()=>{const e=l.value.sessions?.map((e=>({session_id:e.path,raw_id:e.id,kernel:e.kernel,subkernel:e.subkernel,last_active:e.kernel.last_activity,idle:((Date.now()-Date.parse(e.kernel.last_activity))/6e4).toFixed(2),connected:e.kernel.connections>0,process_info:e.process_info,context:e.kernel.context?.name,context_config:e.kernel.context?.config})));return e})),H=(0,r.EW)((()=>q.value.map((e=>e.session_id)))),N=async()=>{const e=s.URLExt.join(n,"/stats"),t=await fetch(e);l.value=await t.json(),X.value=(new Date).toUTCString()},J=async e=>{for(const t of e){const e=s.URLExt.join(n,"/api/sessions/",t),r=await fetch(e,{method:"DELETE",headers:{Authorization:`token ${l.value.token}`}});if(!r.ok){const e=await r.text();a.add({severity:"error",summary:"Error removing session",detail:`${r.status} ${r.statusText} - ${e}`,life:3e3})}}await N()},Y=()=>{0!==V.value.length&&"---"!==Q.value&&"destroy"===Q.value&&Z(V.value)},Z=e=>{t.require({message:`Are you sure you want to proceed? This will destroy session(s): ${e.map((e=>e.session_id)).join(", ")}`,header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined",rejectLabel:"Cancel",acceptLabel:"Confirm",accept:async()=>{await J(e.map((e=>e.raw_id)))},reject:()=>{}})};return(0,r.KC)((()=>{N(),$.value=window.setInterval(N,6e4)})),(0,r.xo)((()=>{clearInterval($.value)})),(e,t)=>((0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)((0,i.R1)(f.A)),(0,r.Lk)("div",k,[(0,r.Lk)("div",null,[m,(0,r.Lk)("div",g,[(0,r.Lk)("span",y,"Last updated: "+(0,o.v_)(X.value),1),(0,r.bF)((0,i.R1)(u.A),{icon:"pi pi-refresh",style:{"margin-left":"1rem"},raised:"",onClick:t[0]||(t[0]=e=>N())})])]),(0,r.Lk)("div",_,[F,(0,r.Lk)("div",R,[(0,r.bF)((0,i.R1)(d.A),{value:[l.value.file_handles]},{header:(0,r.k6)((()=>[A])),default:(0,r.k6)((()=>[(0,r.bF)((0,i.R1)(c.A),{field:"open",header:"Open"}),(0,r.bF)((0,i.R1)(c.A),{field:"total",header:"Total"}),(0,r.bF)((0,i.R1)(c.A),{field:"usage",header:"Usage"})])),_:1},8,["value"]),(0,r.bF)((0,i.R1)(d.A),{value:[l.value.load]},{header:(0,r.k6)((()=>[L])),default:(0,r.k6)((()=>[(0,r.bF)((0,i.R1)(c.A),{field:"1_min",header:"1 Min"}),(0,r.bF)((0,i.R1)(c.A),{field:"5_min",header:"5 Min"}),(0,r.bF)((0,i.R1)(c.A),{field:"15_min",header:"15 Min"})])),_:1},8,["value"]),(0,r.bF)((0,i.R1)(d.A),{value:[l.value.memory]},{header:(0,r.k6)((()=>[x])),default:(0,r.k6)((()=>[(0,r.bF)((0,i.R1)(c.A),{field:"total",header:"Total"}),(0,r.bF)((0,i.R1)(c.A),{field:"used",header:"Used"}),(0,r.bF)((0,i.R1)(c.A),{field:"free",header:"Free"}),(0,r.bF)((0,i.R1)(c.A),{field:"usage",header:"Usage"})])),_:1},8,["value"]),(0,r.bF)((0,i.R1)(d.A),{value:[l.value.disk]},{header:(0,r.k6)((()=>[w])),default:(0,r.k6)((()=>[(0,r.bF)((0,i.R1)(c.A),{field:"total",header:"Total"}),(0,r.bF)((0,i.R1)(c.A),{field:"used",header:"Used"}),(0,r.bF)((0,i.R1)(c.A),{field:"free",header:"Free"}),(0,r.bF)((0,i.R1)(c.A),{field:"usage",header:"Usage"})])),_:1},8,["value"])])]),(0,r.Lk)("div",null,[C,(0,r.bF)((0,i.R1)(d.A),{value:G.value,selection:V.value,"onUpdate:selection":t[2]||(t[2]=e=>V.value=e),"expanded-rows":q.value,"onUpdate:expandedRows":t[3]||(t[3]=e=>q.value=e),"striped-rows":!0,removableSort:""},{header:(0,r.k6)((()=>[(0,r.Lk)("div",U,[j,E,(0,r.Lk)("span",M,"Session count: "+(0,o.v_)(l.value.sessions?.length||0),1),O,(0,r.bF)((0,i.R1)(p.A),{options:["---","destroy"],modelValue:Q.value,"onUpdate:modelValue":t[1]||(t[1]=e=>Q.value=e)},null,8,["modelValue"]),(0,r.bF)((0,i.R1)(u.A),{severity:"success",raised:"",onClick:Y},{default:(0,r.k6)((()=>[(0,r.eW)("Go")])),_:1})])])),expansion:(0,r.k6)((({data:e})=>[(0,r.Lk)("div",null,[B,(0,r.bF)((0,i.R1)(d.A),{value:e.process_info,"striped-rows":!0,removableSort:""},{default:(0,r.k6)((()=>[(0,r.bF)((0,i.R1)(c.A),{field:"pid",header:"PID",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"ppid",header:"Parent PID",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"cpu_pct",header:"CPU Usage %",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"cputime",header:"Cumulative CPU Time",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"mem_pct",header:"Mem Usage (%)",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"mem_bytes",header:"Mem Usage (bytes)",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"threads",header:"Thread count",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"open_files",header:"File handles",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"cmd",header:"Full command",sortable:""})])),_:2},1032,["value"])])])),default:(0,r.k6)((()=>[(0,r.bF)((0,i.R1)(c.A),{class:"selection-column","selection-mode":"multiple"}),(0,r.bF)((0,i.R1)(c.A),{class:"expansion-column",expander:""}),(0,r.bF)((0,i.R1)(c.A),{field:"kernel.id",header:"Beaker Kernel",sortable:""},{body:(0,r.k6)((({data:e})=>[(0,r.Lk)("div",null,(0,o.v_)(e.session_id),1),H.value.includes(e.session_id)?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[S,(0,r.Lk)("div",null,[T,(0,r.eW)(" "+(0,o.v_)(e.kernel.id),1)])],64)):(0,r.Q3)("",!0)])),_:1}),(0,r.bF)((0,i.R1)(c.A),{header:"Subkernel",field:"subkernel.id",sortable:""},{body:(0,r.k6)((({data:e})=>[(0,r.Lk)("div",null,(0,o.v_)(e.subkernel.id),1),H.value.includes(e.session_id)?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[K,(0,r.Lk)("div",null,[P,(0,r.eW)(" "+(0,o.v_)(e.subkernel.name),1)])],64)):(0,r.Q3)("",!0)])),_:1}),(0,r.bF)((0,i.R1)(c.A),{header:"Current Context",field:"context",sortable:""},{body:(0,r.k6)((({data:e})=>[(0,r.Lk)("div",null,(0,o.v_)(e.context),1),H.value.includes(e.session_id)?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[D,I,z,(0,r.Lk)("div",W,(0,o.v_)(e.context_config),1)],64)):(0,r.Q3)("",!0)])),_:1}),(0,r.bF)((0,i.R1)(c.A),{field:"last_active",header:"Last Active",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"idle",header:"Idle Duration (min)",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{field:"connected",header:"User connected",sortable:""}),(0,r.bF)((0,i.R1)(c.A),{header:"Destroy"},{body:(0,r.k6)((({data:e})=>[(0,r.bF)((0,i.R1)(u.A),{style:{height:"2rem",width:"2rem","text-align":"center"},icon:"pi pi-times",severity:"danger",raised:"",onClick:t=>Z([{session_id:e.session_id,raw_id:e.raw_id}])},null,8,["onClick"])])),_:1})])),_:1},8,["value","selection","expanded-rows"])])]),(0,r.bF)((0,i.R1)(b.A),{position:"bottom-right"})],64))}});a(85958);const X=$;var Q=X,V=a(18648),q=a(26883),G=a(8271),H=a(85413);a(96153);const N=s.PageConfig.getBaseUrl();(async()=>{const e=s.URLExt.join(N,"/config"),t=await fetch(e),a=await t.json(),r=(0,n.Ef)(Q,{config:a});r.use(l.Ay),r.use(q.A),r.use(H.A),r.directive("tooltip",V.A),r.directive("focustrap",G.A),r.mount("#app")})()},85958:function(e,t,a){var n=a(82216);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var l=a(68459).A;l("63fd1544",n,!0,{sourceMap:!1,shadowMode:!1})}},t={};function a(n){var l=t[n];if(void 0!==l)return l.exports;var r=t[n]={id:n,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,n,l,r){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],l=e[u][1],r=e[u][2];for(var o=!0,s=0;s<n.length;s++)(!1&r||i>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[s])}))?n.splice(s--,1):(o=!1,r<i&&(i=r));if(o){e.splice(u--,1);var d=l();void 0!==d&&(t=d)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,l,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.j=884}(),function(){a.p="/"}(),function(){a.b=document.baseURI||self.location.href;var e={884:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var l,r,i=n[0],o=n[1],s=n[2],d=0;if(i.some((function(t){return 0!==e[t]}))){for(l in o)a.o(o,l)&&(a.m[l]=o[l]);if(s)var u=s(a)}for(t&&t(n);d<i.length;d++)r=i[d],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},n=self["webpackChunkbeaker_vue"]=self["webpackChunkbeaker_vue"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(90719)}));n=a.O(n),beaker_vue=n})();
//# sourceMappingURL=admin.4cdb43aa.js.map