"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["80821"],{6736:function(t,n,e){e.d(n,{f:function(){return d}});var i=e(11655),r=e(27862),a=e(52565),o=e(92776),u=e(5776),s=e(21475),l=e(77204),c=(e(38419),e(19083),e(71695),e(42713),e(40251),e(61006),e(39527),e(36993),e(47021),e(50778)),d=function(t){var n=(0,s.Z)(null,(function(t,n){var e=function(n){function e(){var n;(0,a.Z)(this,e);for(var i=arguments.length,r=new Array(i),u=0;u<i;u++)r[u]=arguments[u];return n=(0,o.Z)(this,e,[].concat(r)),t(n),n}return(0,u.Z)(e,n),(0,r.Z)(e)}(n);return{F:e,d:[{kind:"field",decorators:[(0,c.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,l.Z)(e,"connectedCallback",this,3)([]),this.__checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,l.Z)(e,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then((function(t){return t()})):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,l.Z)(e,"updated",this,3)([t]),t.has("hass"))this.__checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var n,r=(0,i.Z)(t.keys());try{for(r.s();!(n=r.n()).done;){var a=n.value;if(this.hassSubscribeRequiredHostProps.includes(a))return void this.__checkSubscribed()}}catch(o){r.e(o)}finally{r.f()}}}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"__checkSubscribed",value:function(){var t,n=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((function(t){return void 0===n[t]}))||(this.__unsubs=this.hassSubscribe())}}]}}),t);return n}},70477:function(t,n,e){e.a(t,(async function(t,i){try{e.r(n);var r,a,o,u,s=e(63038),l=e(27862),c=e(52565),d=e(92776),f=e(5776),h=e(21475),v=(e(38419),e(64228),e(13334),e(14394),e(57243)),g=e(50778),_=e(69634),y=(e(54977),e(82062)),p=(e(37583),e(1118)),b=e(17705),k=e(6736),m=e(10188),x=e(93331),Z=t([y,p,m]);[y,p,m]=Z.then?(await Z)():Z;var M={maximumFractionDigits:0};(0,h.Z)([(0,g.Mo)("hui-energy-self-sufficiency-gauge-card")],(function(t,n){var e=function(n){function e(){var n;(0,c.Z)(this,e);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=(0,d.Z)(this,e,[].concat(r)),t(n),n}return(0,f.Z)(e,n),(0,l.Z)(e)}(n);return{F:e,d:[{kind:"field",decorators:[(0,g.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,g.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,g.SB)()],key:"_data",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,n=this;return[(0,p.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){n._data=t}))]}},{kind:"method",key:"getCardSize",value:function(){return 4}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,x.SN)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"render",value:function(){var t;if(!this._config||!this.hass)return v.Ld;if(!this._data)return(0,v.dy)(r||(r=(0,s.Z)(["",""])),this.hass.localize("ui.panel.lovelace.cards.energy.loading"));var n=this._data.prefs,e=(0,p.Jj)(n),i=void 0!==e.solar,u=void 0!==e.battery,l=e.grid[0].flow_to.length>0,c=null!==(t=(0,b.q6)(this._data.stats,e.grid[0].flow_from.map((function(t){return t.stat_energy_from}))))&&void 0!==t?t:0,d=null;i&&(d=(0,b.q6)(this._data.stats,e.solar.map((function(t){return t.stat_energy_from})))||0);var f=null,h=null;u&&(f=(0,b.q6)(this._data.stats,e.battery.map((function(t){return t.stat_energy_to})))||0,h=(0,b.q6)(this._data.stats,e.battery.map((function(t){return t.stat_energy_from})))||0);var g=null;l&&(g=(0,b.q6)(this._data.stats,e.grid[0].flow_to.map((function(t){return t.stat_energy_to})))||0);var y=null;i&&(y=(d||0)-(g||0)-(f||0));var k=null,m=null;null!==y&&y<0&&(u&&(k=-1*y)>c&&(m=k-c,k=c),y=0);var x=null;u&&(x=(h||0)-(m||0));var Z,S=Math.max(0,c-(k||0)),w=Math.max(0,S+(y||0)+(x||0));return null!==c&&null!==w&&w>0&&(Z=100*(1-c/w)),(0,v.dy)(a||(a=(0,s.Z)([" <ha-card> "," </ha-card> "])),void 0!==Z?(0,v.dy)(o||(o=(0,s.Z)([' <ha-svg-icon id="info" .path="','"></ha-svg-icon> <simple-tooltip animation-delay="0" for="info" position="left"> <span> ',' </span> </simple-tooltip> <ha-gauge min="0" max="100" .value="','" label="%" .formatOptions="','" .locale="','" style="','"></ha-gauge> <div class="name"> '," </div> "])),"M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.card_indicates_self_sufficiency_quota"),Z,M,this.hass.locale,(0,_.V)({"--gauge-color":this._computeSeverity(Z)}),this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.self_sufficiency_quota")):this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.self_sufficiency_could_not_calc"))}},{kind:"method",key:"_computeSeverity",value:function(t){return t>75?m.severityMap.green:t<50?m.severityMap.yellow:m.severityMap.normal}},{kind:"get",static:!0,key:"styles",value:function(){return(0,v.iv)(u||(u=(0,s.Z)(["ha-card{height:100%;overflow:hidden;padding:16px;display:flex;align-items:center;justify-content:center;flex-direction:column;box-sizing:border-box}ha-gauge{width:100%;max-width:250px;direction:ltr}.name{text-align:center;line-height:initial;color:var(--primary-text-color);width:100%;font-size:15px;margin-top:8px}ha-svg-icon{position:absolute;right:4px;inset-inline-end:4px;inset-inline-start:initial;top:4px;color:var(--secondary-text-color)}simple-tooltip>span{font-size:12px;line-height:12px}simple-tooltip{width:80%;max-width:250px;top:8px!important}"])))}}]}}),(0,k.f)(v.oi));i()}catch(S){i(S)}}))},32424:function(t,n,e){e.d(n,{E:function(){return a}});var i=e(53907),r=e(18112);function a(t,n,e){var a=(0,r.Q)(t,null==e?void 0:e.in);return isNaN(n)?(0,i.L)((null==e?void 0:e.in)||t,NaN):n?(a.setDate(a.getDate()+n),a):a}},38836:function(t,n,e){e.d(n,{T:function(){return a}});var i=e(23711),r=e(76808);function a(t,n,e){return(0,i.n)(t,n*r.vh,e)}},23711:function(t,n,e){e.d(n,{n:function(){return a}});var i=e(53907),r=e(18112);function a(t,n,e){return(0,i.L)((null==e?void 0:e.in)||t,+(0,r.Q)(t)+n)}},23459:function(t,n,e){e.d(n,{z:function(){return a}});var i=e(53907),r=e(18112);function a(t,n,e){var a=(0,r.Q)(t,null==e?void 0:e.in);if(isNaN(n))return(0,i.L)((null==e?void 0:e.in)||t,NaN);if(!n)return a;var o=a.getDate(),u=(0,i.L)((null==e?void 0:e.in)||t,a.getTime());return u.setMonth(a.getMonth()+n+1,0),o>=u.getDate()?u:(a.setFullYear(u.getFullYear(),u.getMonth(),o),a)}},2425:function(t,n,e){e.d(n,{U:function(){return r}});var i=e(18112);function r(t,n){var e=+(0,i.Q)(t)-+(0,i.Q)(n);return e<0?-1:e>0?1:e}},6542:function(t,n,e){e.d(n,{d:function(){return s}});var i=e("22936"),r=e("18492"),a=e("2425");function o(t,n,e){var a=(0,r.d)(null==e?void 0:e.in,t,n),o=(0,i.Z)(a,2),u=o[0],s=o[1];return 12*(u.getFullYear()-s.getFullYear())+(u.getMonth()-s.getMonth())}var u=e("3938");function s(t,n,e){var s=(0,r.d)(null==e?void 0:e.in,t,t,n),l=(0,i.Z)(s,3),c=l[0],d=l[1],f=l[2],h=(0,a.U)(d,f),v=Math.abs(o(d,f));if(v<1)return 0;1===d.getMonth()&&d.getDate()>27&&d.setDate(30),d.setMonth(d.getMonth()-h*v);var g=(0,a.U)(d,f)===-h;(0,u.h)(c)&&1===v&&1===(0,a.U)(c,f)&&(g=!1);var _=h*(v-+g);return 0===_?0:_}},96500:function(t,n,e){e.d(n,{i:function(){return r}});var i=e(18112);function r(t,n){var e=(0,i.Q)(t,null==n?void 0:n.in);return e.setHours(23,59,59,999),e}},2621:function(t,n,e){e.d(n,{V:function(){return r}});var i=e(18112);function r(t,n){var e=(0,i.Q)(t,null==n?void 0:n.in),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}},86319:function(t,n,e){e.d(n,{b:function(){return r}});var i=e(18112);function r(t,n){return 1===(0,i.Q)(t,null==n?void 0:n.in).getDate()}},3938:function(t,n,e){e.d(n,{h:function(){return o}});var i=e(96500),r=e(2621),a=e(18112);function o(t,n){var e=(0,a.Q)(t,null==n?void 0:n.in);return+(0,i.i)(e,n)==+(0,r.V)(e,n)}}}]);
//# sourceMappingURL=80821.b6cc6e69cd11d1f7.js.map