"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["25804"],{97547:function(t,e,n){n.a(t,(async function(t,i){try{n.r(e),n.d(e,{computeStateDisplay:function(){return h},computeStateDisplayFromEntityAttributes:function(){return _}});n(38419),n(19083),n(83069),n(19423),n(61006);var s=n(96194),a=n(20382),r=n(54363),o=n(46467),c=n(64214),u=n(33570),l=n(50602),m=n(87974),f=n(73850),d=t([r,o,u,l,c]);[r,o,u,l,c]=d.then?(await d)():d;var h=function(t,e,n,i,s,a,r){var o=null==a?void 0:a[e.entity_id];return _(t,n,i,s,o,e.entity_id,e.attributes,void 0!==r?r:e.state)},_=function(t,e,n,i,d,h,_,v){if(v===s.lz||v===s.nZ)return t("state.default.".concat(v));var y=(0,f.M)(h);if((0,l.sJ)(_,"sensor"===y?n:[])){if("duration"===_.device_class&&_.unit_of_measurement&&r.a_.includes(_.unit_of_measurement))try{return(0,r.LU)(e,v,_.unit_of_measurement,null==d?void 0:d.display_precision)}catch(j){}if("monetary"===_.device_class)try{return(0,l.uf)(v,e,Object.assign({style:"currency",currency:_.unit_of_measurement,minimumFractionDigits:2},(0,l.l4)({state:v,attributes:_},d)))}catch(j){}var b=(0,l.uf)(v,e,(0,l.l4)({state:v,attributes:_},d)),g=(null==d?void 0:d.translation_key)&&t("component.".concat(d.platform,".entity.").concat(y,".").concat(d.translation_key,".unit_of_measurement"))||_.unit_of_measurement;return g?"".concat(b).concat((0,m.L)(g,e)).concat(g):b}if("datetime"===y){var p=new Date(v);return(0,c.o0)(p,e,i)}if(["date","input_datetime","time"].includes(y))try{var w=v.split(" ");if(2===w.length)return(0,c.o0)(new Date(w.join("T")),Object.assign(Object.assign({},e),{},{time_zone:a.c_.local}),i);if(1===w.length){if(v.includes("-"))return(0,o.p6)(new Date("".concat(v,"T00:00")),Object.assign(Object.assign({},e),{},{time_zone:a.c_.local}),i);if(v.includes(":")){var O=new Date;return(0,u.mr)(new Date("".concat(O.toISOString().split("T")[0],"T").concat(v)),Object.assign(Object.assign({},e),{},{time_zone:a.c_.local}),i)}}return v}catch(k){return v}if("counter"===y||"number"===y||"input_number"===y)return(0,l.uf)(v,e,(0,l.l4)({state:v,attributes:_},d));if(["button","conversation","event","image","input_button","notify","scene","stt","tag","tts","wake_word"].includes(y)||"sensor"===y&&"timestamp"===_.device_class)try{return(0,c.o0)(new Date(v),e,i)}catch(j){return v}return(null==d?void 0:d.translation_key)&&t("component.".concat(d.platform,".entity.").concat(y,".").concat(d.translation_key,".state.").concat(v))||_.device_class&&t("component.".concat(y,".entity_component.").concat(_.device_class,".state.").concat(v))||t("component.".concat(y,".entity_component._.state.").concat(v))||v};i()}catch(v){i(v)}}))},6280:function(t,e,n){n.a(t,(async function(t,i){try{n.d(e,{Nu:function(){return j},Vk:function(){return v},xS:function(){return b},xj:function(){return k}});var s=n(10265),a=n(11655),r=n(52565),o=n(27862),c=(n(38419),n(91599),n(18801),n(19083),n(71695),n(83069),n(64228),n(92745),n(61893),n(84283),n(19423),n(52961),n(42713),n(61427),n(92519),n(42179),n(89256),n(24931),n(88463),n(57449),n(19814),n(61006),n(99341),n(39527),n(99790),n(67670),n(41360),n(13334),n(36993),n(49207),n(47021),n(73850)),u=n(97547),l=n(47194),m=t([u]);u=(m.then?(await m)():m)[0];var f=["climate","humidifier","water_heater"],d=["climate","humidifier","input_datetime","thermostat","water_heater","person","device_tracker"],h=["temperature","current_temperature","target_temp_low","target_temp_high","hvac_action","humidity","mode","action","current_humidity"],_=function(t,e){return!t.states[e]||d.includes((0,c.M)(e))},v=function(t,e,n,i,s){var a={type:"history/stream",entity_ids:s,start_time:n.toISOString(),end_time:i.toISOString(),minimal_response:!0,no_attributes:!s.some((function(e){return _(t,e)}))},r=new y(t);return t.connection.subscribeMessage((function(t){return e(r.processMessage(t))}),a)},y=function(){return(0,o.Z)((function t(e,n){(0,r.Z)(this,t),this.hass=void 0,this.hoursToShow=void 0,this.combinedHistory=void 0,this.hass=e,this.hoursToShow=n,this.combinedHistory={}}),[{key:"processMessage",value:function(t){if(!this.combinedHistory||!Object.keys(this.combinedHistory).length)return this.combinedHistory=t.states,this.combinedHistory;if(!Object.keys(t.states).length)return this.combinedHistory;for(var e=this.hoursToShow?((new Date).getTime()-3600*this.hoursToShow*1e3)/1e3:void 0,n={},i=0,s=Object.keys(this.combinedHistory);i<s.length;i++){n[s[i]]=[]}for(var a=0,r=Object.keys(t.states);a<r.length;a++){n[r[a]]=[]}for(var o=0,c=Object.keys(n);o<c.length;o++){var u=c[o];if(u in this.combinedHistory&&u in t.states){var l=this.combinedHistory[u],m=l[l.length-1];n[u]=l.concat(t.states[u]),t.states[u][0].lu<m.lu&&(n[u]=n[u].sort((function(t,e){return t.lu-e.lu})))}else u in this.combinedHistory?n[u]=this.combinedHistory[u]:n[u]=t.states[u];if(e&&u in this.combinedHistory){var f=n[u].filter((function(t){return t.lu<e}));if(!f.length)continue;if(n[u]=n[u].filter((function(t){return t.lu>=e})),n[u].length&&n[u][0].lu===e)continue;var d=f[f.length-1];d.lu=e,n[u].unshift(d)}}return this.combinedHistory=n,this.combinedHistory}}])}(),b=function(t,e,n,i){var s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=arguments.length>6?arguments[6]:void 0,o={type:"history/stream",entity_ids:i,start_time:new Date((new Date).getTime()-3600*n*1e3).toISOString(),minimal_response:s,significant_changes_only:a,no_attributes:null!=r?r:!i.some((function(e){return _(t,e)}))},c=new y(t,n);return t.connection.subscribeMessage((function(t){return e(c.processMessage(t))}),o)},g=function(t,e){return t.state===e.state&&(!t.attributes||!e.attributes||h.every((function(n){return t.attributes[n]===e.attributes[n]})))},p=["counter","input_number","number"],w=function(t){return p.includes(t)},O=function(t){return"unit_of_measurement"in t||"state_class"in t},j=function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],m=arguments.length>6&&void 0!==arguments[6]&&arguments[6],d={},_=[],v={};return new Set([].concat((0,s.Z)(n),(0,s.Z)(Object.keys(e)))).forEach((function(n){n in e?v[n]=e[n]:t.states[n]&&(v[n]=[{s:t.states[n].state,a:t.states[n].attributes,lu:new Date(t.states[n].last_updated).getTime()/1e3}])})),v?(Object.keys(v).forEach((function(e){var n,f=v[e];if(0!==f.length){var h,y=(0,c.M)(e),b=e in t.states?t.states[e]:void 0,g=b||w(y)?void 0:f.find((function(t){return t.a&&O(t.a)})),p=m||w(y)||null!=b&&O(b.attributes)||null!=b&&"sensor"===y&&function(t,e){return null!=t.attributes.device_class&&e.includes(t.attributes.device_class)}(b,r)||null!=g;h=p?(null==b?void 0:b.attributes.unit_of_measurement)||(null==g?void 0:g.a.unit_of_measurement)||" ":{zone:i("ui.dialogs.more_info_control.zone.graph_unit"),climate:t.config.unit_system.temperature,humidifier:"%",water_heater:t.config.unit_system.temperature}[y];var j={climate:"temperature",humidifier:"humidity",water_heater:"temperature"}[y]||(null===(n=(null==b?void 0:b.attributes)||(null==g?void 0:g.a))||void 0===n?void 0:n.device_class),S=k(h,j,o);if(h)if(S&&S in d&&e in d[S]){var H;(H=d[S][e]).push.apply(H,(0,s.Z)(f))}else S&&(S in d||(d[S]={}),d[S][e]=f);else _.push(function(t,e,n,i,s,r,o){var c,m=[],f=r[0],d=(0,a.Z)(r);try{for(d.s();!(c=d.n()).done;){var h=c.value;if(!(m.length>0&&h.s===m[m.length-1].state)){var _={};null!=o&&o.attributes.device_class&&(_.device_class=null==o?void 0:o.attributes.device_class),m.push({state_localize:(0,u.computeStateDisplayFromEntityAttributes)(t,e,[],n,i[s],s,Object.assign(Object.assign({},h.a||f.a),_),h.s),state:h.s,last_changed:1e3*(h.lc?h.lc:h.lu)})}}}catch(v){d.e(v)}finally{d.f()}return{name:(0,l.a)(s,(null==o?void 0:o.attributes)||f.a),entity_id:s,data:m}}(i,t.locale,t.config,t.entities,e,f,b))}})),{line:Object.keys(d).map((function(e){var n=e.split("_");return function(t,e,n,i){var s=[];return Object.keys(n).forEach((function(t){var e,r=n[t],o=r[0],u=(0,c.M)(t),m=[],d=(0,a.Z)(r);try{for(d.s();!(e=d.n()).done;){var _=e.value,v=void 0;if(f.includes(u)){v={state:_.s,last_changed:1e3*_.lu,attributes:{}};for(var y=0,b=h;y<b.length;y++){var p=b[y];p in _.a&&(v.attributes[p]=_.a[p])}}else v={state:_.s,last_changed:1e3*(_.lc?_.lc:_.lu),attributes:{}};m.length>1&&g(v,m[m.length-1])&&g(v,m[m.length-2])||m.push(v)}}catch(O){d.e(O)}finally{d.f()}var w=t in i?i[t].attributes:"friendly_name"in o.a?o.a:void 0;s.push({domain:u,name:(0,l.a)(t,w||{}),entity_id:t,states:m})})),{unit:t,device_class:e,identifier:Object.keys(n).join(""),data:s}}(n[0],n[1]||void 0,d[e],t.states)})),timeline:_}):{line:[],timeline:[]}},k=function(t,e,n){return n?"".concat(t,"_").concat(e||""):t};i()}catch(S){i(S)}}))}}]);
//# sourceMappingURL=25804.88ede3fba43f6d64.js.map