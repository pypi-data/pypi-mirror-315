"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["75692"],{97206:function(e,t,r){r.r(t),r.d(t,{HaCircularProgress:function(){return b}});var n,i=r(63038),s=r(10265),o=r(27862),a=r(52565),u=r(92776),c=r(5776),d=r(21475),l=r(77204),h=(r(38419),r(58795)),f=r(57243),k=r(50778),b=(0,d.Z)([(0,k.Mo)("ha-circular-progress")],(function(e,t){var r=function(t){function r(){var t;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=(0,u.Z)(this,r,[].concat(i)),e(t),t}return(0,c.Z)(r,t),(0,o.Z)(r)}(t);return{F:r,d:[{kind:"field",decorators:[(0,k.Cb)({attribute:"aria-label",type:String})],key:"ariaLabel",value:function(){return"Loading"}},{kind:"field",decorators:[(0,k.Cb)()],key:"size",value:function(){return"medium"}},{kind:"method",key:"updated",value:function(e){if((0,l.Z)(r,"updated",this,3)([e]),e.has("size"))switch(this.size){case"tiny":this.style.setProperty("--md-circular-progress-size","16px");break;case"small":this.style.setProperty("--md-circular-progress-size","28px");break;case"medium":this.style.setProperty("--md-circular-progress-size","48px");break;case"large":this.style.setProperty("--md-circular-progress-size","68px")}}},{kind:"field",static:!0,key:"styles",value:function(){return[].concat((0,s.Z)((0,l.Z)(r,"styles",this)),[(0,f.iv)(n||(n=(0,i.Z)([":host{--md-sys-color-primary:var(--primary-color);--md-circular-progress-size:48px}"])))])}}]}}),h.B)},16581:function(e,t,r){r.a(e,(async function(e,t){try{var n,i,s,o,a,u=r(11655),c=r(10265),d=r(9833),l=r(94524),h=r(63038),f=r(27862),k=r(52565),b=r(92776),v=r(5776),p=r(21475),g=r(77204),m=(r(52247),r(38419),r(91599),r(19083),r(92745),r(61495),r(61893),r(63619),r(42713),r(37362),r(61006),r(39527),r(99790),r(41360),r(36993),r(49207),r(57243)),_=r(50778),y=r(72344),w=r(59847),Z=r(93826),x=(r(97206),r(49277)),E=r(75244),C=r(4242),S=r(82480),L=e([S]);S=(L.then?(await L)():L)[0];var T=function(e,t){return new Date(e.getTime()-1e3*t).getTime()/1e3},z=function(e,t){return(void 0!==e||void 0!==t)&&(!e||!t||e.length!==t.length||e.some((function(e){return!t.includes(e)}))||t.some((function(t){return!e.includes(t)})))};(0,p.Z)([(0,_.Mo)("ha-logbook")],(function(e,t){var r,p,S,L,I,B,P=function(t){function r(){var t;(0,k.Z)(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=(0,b.Z)(this,r,[].concat(i)),e(t),t}return(0,v.Z)(r,t),(0,f.Z)(r)}(t);return{F:P,d:[{kind:"field",decorators:[(0,_.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,_.Cb)({attribute:!1})],key:"time",value:void 0},{kind:"field",decorators:[(0,_.Cb)({attribute:!1})],key:"entityIds",value:void 0},{kind:"field",decorators:[(0,_.Cb)({attribute:!1})],key:"deviceIds",value:void 0},{kind:"field",decorators:[(0,_.Cb)({type:Boolean})],key:"narrow",value:function(){return!1}},{kind:"field",decorators:[(0,_.Cb)({type:Boolean,reflect:!0})],key:"virtualize",value:function(){return!1}},{kind:"field",decorators:[(0,_.Cb)({type:Boolean,attribute:"no-icon"})],key:"noIcon",value:function(){return!1}},{kind:"field",decorators:[(0,_.Cb)({type:Boolean,attribute:"no-name"})],key:"noName",value:function(){return!1}},{kind:"field",decorators:[(0,_.Cb)({type:Boolean,attribute:"show-indicator"})],key:"showIndicator",value:function(){return!1}},{kind:"field",decorators:[(0,_.Cb)({type:Boolean,attribute:"relative-time"})],key:"relativeTime",value:function(){return!1}},{kind:"field",decorators:[(0,_.Cb)({type:Boolean})],key:"showMoreLink",value:function(){return!0}},{kind:"field",decorators:[(0,_.SB)()],key:"_logbookEntries",value:void 0},{kind:"field",decorators:[(0,_.SB)()],key:"_traceContexts",value:function(){return{}}},{kind:"field",decorators:[(0,_.SB)()],key:"_userIdToName",value:function(){return{}}},{kind:"field",decorators:[(0,_.SB)()],key:"_error",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"field",key:"_liveUpdatesEnabled",value:function(){return!0}},{kind:"field",key:"_pendingStreamMessages",value:function(){return[]}},{kind:"field",key:"_throttleGetLogbookEntries",value:function(){var e=this;return(0,Z.P)((function(){return e._getLogBookData()}),1e3)}},{kind:"method",key:"render",value:function(){return(0,y.p)(this.hass,"logbook")?this._error?(0,m.dy)(n||(n=(0,h.Z)(['<div class="no-entries"> '," </div>"])),"".concat(this.hass.localize("ui.components.logbook.retrieval_error"),": ").concat(this._error)):void 0===this._logbookEntries?(0,m.dy)(i||(i=(0,h.Z)([' <div class="progress-wrapper"> <ha-circular-progress indeterminate></ha-circular-progress> </div> ']))):0===this._logbookEntries.length?(0,m.dy)(s||(s=(0,h.Z)(['<div class="no-entries"> '," </div>"])),this.hass.localize("ui.components.logbook.entries_not_found")):(0,m.dy)(o||(o=(0,h.Z)([' <ha-logbook-renderer .hass="','" .narrow="','" .virtualize="','" .noIcon="','" .noName="','" .showIndicator="','" .relativeTime="','" .entries="','" .traceContexts="','" .userIdToName="','" @hass-logbook-live="','"></ha-logbook-renderer> '])),this.hass,this.narrow,this.virtualize,this.noIcon,this.noName,this.showIndicator,this.relativeTime,this._logbookEntries,this._traceContexts,this._userIdToName,this._handleLogbookLive):m.Ld}},{kind:"method",key:"refresh",value:(B=(0,l.Z)((0,d.Z)().mark((function e(){var t,r=arguments;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=r.length>0&&void 0!==r[0]&&r[0])||!this._subscribed&&void 0!==this._logbookEntries){e.next=3;break}return e.abrupt("return");case 3:return this._throttleGetLogbookEntries.cancel(),this._updateTraceContexts.cancel(),this._updateUsers.cancel(),e.next=8,this._unsubscribeSetLoading();case 8:this._liveUpdatesEnabled=!0,t?this._getLogBookData():this._throttleGetLogbookEntries();case 10:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{kind:"method",key:"shouldUpdate",value:function(e){if(1!==e.size||!e.has("hass"))return!0;var t=e.get("hass");return!t||t.localize!==this.hass.localize}},{kind:"method",key:"willUpdate",value:function(e){for(var t=e.has("time"),r=0,n=["entityIds","deviceIds"];r<n.length;r++){var i=n[r];if(e.has(i)){var s=e.get(i),o=this[i];if(z(s,o)){t=!0;break}}}t&&this.refresh(!0)}},{kind:"method",key:"_handleLogbookLive",value:function(e){var t=this;e.detail.enable&&!this._liveUpdatesEnabled&&(this._pendingStreamMessages.forEach((function(e){return t._processStreamMessage(e)})),this._pendingStreamMessages=[]),this._liveUpdatesEnabled=e.detail.enable}},{kind:"get",key:"_filterAlwaysEmptyResults",value:function(){var e=this.entityIds,t=this.deviceIds;return Boolean(e||t)&&(!e||0===e.length)&&(!t||0===t.length)}},{kind:"method",key:"_unsubscribe",value:(I=(0,l.Z)((0,d.Z)().mark((function e(){var t;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._subscribed){e.next=15;break}return e.prev=1,e.next=4,this._subscribed;case 4:if(!(t=e.sent)){e.next=10;break}return e.next=8,t();case 8:this._subscribed=void 0,this._pendingStreamMessages=[];case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("Error unsubscribing:",e.t0);case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(){return I.apply(this,arguments)})},{kind:"method",key:"connectedCallback",value:function(){(0,g.Z)(P,"connectedCallback",this,3)([]),this.hasUpdated&&this._subscribeLogbookPeriod(this._calculateLogbookPeriod())}},{kind:"method",key:"disconnectedCallback",value:function(){(0,g.Z)(P,"disconnectedCallback",this,3)([]),this._unsubscribeSetLoading()}},{kind:"method",key:"_unsubscribeSetLoading",value:(L=(0,l.Z)((0,d.Z)().mark((function e(){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribe();case 2:this._logbookEntries=void 0,this._pendingStreamMessages=[];case 4:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{kind:"method",key:"_unsubscribeNoResults",value:(S=(0,l.Z)((0,d.Z)().mark((function e(){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribe();case 2:this._logbookEntries=[],this._pendingStreamMessages=[];case 4:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{kind:"method",key:"_calculateLogbookPeriod",value:function(){var e=new Date;if("range"in this.time)return{now:e,startTime:this.time.range[0],endTime:this.time.range[1],purgeBeforePythonTime:void 0};if("recent"in this.time){var t=T(e,this.time.recent);return{now:e,startTime:new Date(1e3*t),endTime:new Date(e.getTime()+31536e6),purgeBeforePythonTime:T(e,this.time.recent)}}throw new Error("Unexpected time specified")}},{kind:"method",key:"_subscribeLogbookPeriod",value:(p=(0,l.Z)((0,d.Z)().mark((function e(t){var r=this;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._subscribed){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,this._unsubscribe();case 4:return this._subscribed=(0,x.Yc)(this.hass,(function(e){r._subscribed&&r._processOrQueueStreamMessage(e)}),t.startTime.toISOString(),t.endTime.toISOString(),this.entityIds,this.deviceIds).catch((function(e){r._subscribed=void 0,r._error=e})),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{kind:"method",key:"_getLogBookData",value:(r=(0,l.Z)((0,d.Z)().mark((function e(){var t,r;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._error=void 0,!this._filterAlwaysEmptyResults){e.next=5;break}return e.next=4,this._unsubscribeNoResults();case 4:return e.abrupt("return");case 5:if(!((r=this._calculateLogbookPeriod()).startTime>r.now)){e.next=10;break}return e.next=9,this._unsubscribeNoResults();case 9:return e.abrupt("return");case 10:this._updateUsers(),null!==(t=this.hass.user)&&void 0!==t&&t.is_admin&&this._updateTraceContexts(),this._subscribeLogbookPeriod(r);case 13:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{kind:"field",key:"_nonExpiredRecords",value:function(){var e=this;return function(t){return e._logbookEntries?t?e._logbookEntries.filter((function(e){return e.when>t})):e._logbookEntries:[]}}},{kind:"field",key:"_processOrQueueStreamMessage",value:function(){var e=this;return function(t){e._liveUpdatesEnabled?e._processStreamMessage(t):e._pendingStreamMessages.push(t)}}},{kind:"field",key:"_processStreamMessage",value:function(){var e=this;return function(t){var r="recent"in e.time?T(new Date,e.time.recent):void 0,n=(0,c.Z)(t.events).reverse();if(e._logbookEntries&&e._logbookEntries.length){if(n.length){var i=e._nonExpiredRecords(r);i.length?n[n.length-1].when>i[0].when?e._logbookEntries=n.concat(i):i[i.length-1].when>n[0].when?e._logbookEntries=i.concat(n):e._logbookEntries=i.concat(n).sort((function(e,t){return t.when-e.when})):e._logbookEntries=n}}else e._logbookEntries=n}}},{kind:"field",key:"_updateTraceContexts",value:function(){var e=this;return(0,Z.P)((0,l.Z)((0,d.Z)().mark((function t(){return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,E.U_)(e.hass);case 2:e._traceContexts=t.sent;case 3:case"end":return t.stop()}}),t)}))),6e4)}},{kind:"field",key:"_updateUsers",value:function(){var e=this;return(0,Z.P)((0,l.Z)((0,d.Z)().mark((function t(){var r,n,i,s,o,a,c,l,h,f;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n={},i=(null===(r=e.hass.user)||void 0===r?void 0:r.is_admin)&&(0,C.uh)(e.hass),s=0,o=Object.values(e.hass.states);s<o.length;s++)(a=o[s]).attributes.user_id&&"person"===(0,w.N)(a)&&(n[a.attributes.user_id]=a.attributes.friendly_name);if(!i){t.next=9;break}return t.next=6,i;case 6:c=t.sent,l=(0,u.Z)(c);try{for(l.s();!(h=l.n()).done;)(f=h.value).id in n||(n[f.id]=f.name)}catch(d){l.e(d)}finally{l.f()}case 9:e._userIdToName=n;case 10:case"end":return t.stop()}}),t)}))),6e4)}},{kind:"get",static:!0,key:"styles",value:function(){return[(0,m.iv)(a||(a=(0,h.Z)([":host{display:block}:host([virtualize]){height:100%}.no-entries{text-align:center;padding:16px;color:var(--secondary-text-color)}.progress-wrapper{display:flex;justify-content:center;height:100%;align-items:center}"])))]}}]}}),m.oi);t()}catch(I){t(I)}}))},88238:function(e,t,r){r.d(t,{RU:function(){return i},X1:function(){return n},u4:function(){return s},zC:function(){return o}});r(38419),r(88044);var n=function(e){return"https://brands.home-assistant.io/".concat(e.brand?"brands/":"").concat(e.useFallback?"_/":"").concat(e.domain,"/").concat(e.darkOptimized?"dark_":"").concat(e.type,".png")},i=function(e){return"https://brands.home-assistant.io/hardware/".concat(e.category,"/").concat(e.darkOptimized?"dark_":"").concat(e.manufacturer).concat(e.model?"_".concat(e.model):"",".png")},s=function(e){return e.split("/")[4]},o=function(e){return e.startsWith("https://brands.home-assistant.io/")}}}]);
//# sourceMappingURL=75692.420af1f9a22d2943.js.map