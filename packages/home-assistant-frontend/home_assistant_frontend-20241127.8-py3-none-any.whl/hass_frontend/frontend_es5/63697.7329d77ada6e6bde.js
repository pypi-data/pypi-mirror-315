"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["63697"],{50875:function(t,e,a){a.d(e,{Eu:function(){return s},hZ:function(){return r}});var n=a(11259),i=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function s(t){return i[t%i.length]}function r(t,e){var a=e.getPropertyValue("--graph-color-".concat(t+1))||s(t);return(0,n.Rq)(a)}},68958:function(t,e,a){a.d(e,{t:function(){return o}});var n=a(52565),i=a(27862),s=(a(80133),a(92745),a(22879),a(77439),a(19423),a(52961),a(42713),a(39527),a(41360),a(88972),a(49207),function(){return(0,i.Z)((function t(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.localStorage;(0,n.Z)(this,t),this.storage=void 0,this._storage={},this._listeners={},this.storage=a,a===window.localStorage&&window.addEventListener("storage",(function(t){t.key&&e.hasKey(t.key)&&(e._storage[t.key]=t.newValue?JSON.parse(t.newValue):t.newValue,e._listeners[t.key]&&e._listeners[t.key].forEach((function(a){return a(t.oldValue?JSON.parse(t.oldValue):t.oldValue,e._storage[t.key])})))}))}),[{key:"addFromStorage",value:function(t){if(!this._storage[t]){var e=this.storage.getItem(t);e&&(this._storage[t]=JSON.parse(e))}}},{key:"subscribeChanges",value:function(t,e){var a=this;return this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e],function(){a.unsubscribeChanges(t,e)}}},{key:"unsubscribeChanges",value:function(t,e){if(t in this._listeners){var a=this._listeners[t].indexOf(e);-1!==a&&this._listeners[t].splice(a,1)}}},{key:"hasKey",value:function(t){return t in this._storage}},{key:"getValue",value:function(t){return this._storage[t]}},{key:"setValue",value:function(t,e){var a=this._storage[t];this._storage[t]=e;try{void 0===e?this.storage.removeItem(t):this.storage.setItem(t,JSON.stringify(e))}catch(n){}finally{this._listeners[t]&&this._listeners[t].forEach((function(t){return t(a,e)}))}}}])}()),r={},o=function(t){return function(e){var a,n=t.storage||"localStorage";n&&n in r?a=r[n]:(a=new s(window[n]),r[n]=a);var i=String(e.key),o=t.key||String(e.key),d=e.initializer?e.initializer():void 0;a.addFromStorage(o);var c=!1!==t.subscribe?function(t){return a.subscribeChanges(o,(function(a,n){t.requestUpdate(e.key,a)}))}:void 0,u=function(){return a.hasKey(o)?t.deserializer?t.deserializer(a.getValue(o)):a.getValue(o):d};return{kind:"method",placement:"prototype",key:e.key,descriptor:{set:function(n){!function(n,i){var s;t.state&&(s=u()),a.setValue(o,t.serializer?t.serializer(i):i),t.state&&n.requestUpdate(e.key,s)}(this,n)},get:function(){return u()},enumerable:!0,configurable:!0},finisher:function(a){if(t.state&&t.subscribe){var n=a.prototype.connectedCallback,s=a.prototype.disconnectedCallback;a.prototype.connectedCallback=function(){n.call(this),this["__unbsubLocalStorage".concat(i)]=null==c?void 0:c(this)},a.prototype.disconnectedCallback=function(){var t;s.call(this),null===(t=this["__unbsubLocalStorage".concat(i)])||void 0===t||t.call(this),this["__unbsubLocalStorage".concat(i)]=void 0}}t.state&&a.createProperty(e.key,Object.assign({noAccessor:!0},t.stateOptions))}}}}},18520:function(t,e,a){a.d(e,{n:function(){return n}});var n=function(t){return!(t.native instanceof MouseEvent)||t.native instanceof PointerEvent&&"mouse"!==t.native.pointerType}},6736:function(t,e,a){a.d(e,{f:function(){return l}});var n=a(11655),i=a(27862),s=a(52565),r=a(92776),o=a(5776),d=a(21475),c=a(77204),u=(a(38419),a(19083),a(71695),a(42713),a(40251),a(61006),a(39527),a(36993),a(47021),a(50778)),l=function(t){var e=(0,d.Z)(null,(function(t,e){var a=function(e){function a(){var e;(0,s.Z)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=(0,r.Z)(this,a,[].concat(i)),t(e),e}return(0,o.Z)(a,e),(0,i.Z)(a)}(e);return{F:a,d:[{kind:"field",decorators:[(0,u.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,c.Z)(a,"connectedCallback",this,3)([]),this.__checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,c.Z)(a,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then((function(t){return t()})):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,c.Z)(a,"updated",this,3)([t]),t.has("hass"))this.__checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var e,i=(0,n.Z)(t.keys());try{for(i.s();!(e=i.n()).done;){var s=e.value;if(this.hassSubscribeRequiredHostProps.includes(s))return void this.__checkSubscribed()}}catch(r){i.e(r)}finally{i.f()}}}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"__checkSubscribed",value:function(){var t,e=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((function(t){return void 0===e[t]}))||(this.__unsubs=this.hassSubscribe())}}]}}),t);return e}},20548:function(t,e,a){a.d(e,{H:function(){return s}});a(81804);var n=a(11259),i=a(4643);function s(t,e,a,s,r,o){var d=t.getPropertyValue(r+"-"+o).trim(),c=d.length>0?d:t.getPropertyValue(r).trim(),u=(0,n.Rq)(c);return 0===d.length&&o&&(u=(0,n.CO)((0,n.p3)(e?(0,i.C)((0,n.Rw)((0,n.wK)(u)),o):(0,i.W)((0,n.Rw)((0,n.wK)(u)),o)))),s?u+=a?"32":"7F":a&&(u+="7F"),u}},53259:function(t,e,a){a.a(t,(async function(t,n){try{a.d(e,{J:function(){return v}});a(38419),a(19423);var i=a(21893),s=a(13809),r=a(13633),o=a(38836),d=a(50602),c=a(46467),u=a(33570),l=t([c,u,d]);function f(t,e){var a=new Date(e);return t>2&&0===a.getHours()&&(a=(0,i.b)(a,1)),a.setMinutes(0,0,0),t>35&&a.setDate(1),t>2&&a.setHours(0),a.getTime()}function v(t,e,a,n,i,l,h){var v=(0,s.j)(e,t),p=void 0!==l&&void 0!==h;if(p&&v<=35){var _=(0,r.A)(e,t),k=(0,r.A)(h,l);k>_?e=(0,o.T)(e,k-_):_>k&&(h=(0,o.T)(h,_-k))}var b={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:f(v,e),adapters:{date:{locale:a,config:n}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:v>35?"monthyear":v>7?"date":v>2?"weekday":v>0?"datetime":"hour",minUnit:v>35?"month":v>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:function(t){return(0,d.uf)(Math.abs(t),a)}}}},plugins:{tooltip:{position:"nearest",filter:function(t){return"0"!==t.formattedValue},itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:function(t){if(v>0)return t[0].label;var e=new Date(t[0].parsed.x);return"".concat(p?"".concat((0,c.ud)(e,a,n),": "):"").concat((0,u.mr)(e,a,n)," â€“ ").concat((0,u.mr)((0,o.T)(e,1),a,n))},label:function(t){return"".concat(t.dataset.label,": ").concat((0,d.uf)(t.parsed.y,a)," ").concat(i)}}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,d.Hd)(a)};return p&&(b.scales.xAxisCompare=Object.assign(Object.assign({},b.scales.x),{},{suggestedMin:l.getTime(),max:f(v,h),display:!1})),b}[c,u,d]=l.then?(await l)():l,n()}catch(h){n(h)}}))},36681:function(t,e,a){a.a(t,(async function(t,n){try{a.r(e),a.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return V}});var i,s,r,o=a(11655),d=a(10265),c=a(63038),u=a(27862),l=a(52565),h=a(92776),f=a(5776),v=a(21475),p=(a(38419),a(91599),a(19083),a(80133),a(64228),a(92745),a(61893),a(63619),a(23509),a(19423),a(52961),a(42713),a(61006),a(39527),a(99790),a(41360),a(13334),a(49207),a(42625)),_=a(83389),k=a(57243),b=a(50778),y=a(35359),g=a(27486),m=a(50875),S=a(20548),x=(a(54977),a(25179),a(1118)),C=a(17705),w=a(6736),Z=a(93331),E=a(53259),D=a(36522),O=a(68958),H=a(18520),I=t([E,x]);[E,x]=I.then?(await I)():I;var V=(0,v.Z)([(0,b.Mo)("hui-energy-devices-detail-graph-card")],(function(t,e){var a=function(e){function a(){var e;(0,l.Z)(this,a);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e=(0,h.Z)(this,a,[].concat(i)),t(e),e}return(0,f.Z)(a,e),(0,u.Z)(a)}(e);return{F:a,d:[{kind:"field",decorators:[(0,b.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,b.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,b.SB)()],key:"_chartData",value:function(){return{datasets:[]}}},{kind:"field",decorators:[(0,b.SB)()],key:"_chartDatasetExtra",value:function(){return[]}},{kind:"field",decorators:[(0,b.SB)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,b.SB)()],key:"_start",value:function(){return(0,p.I)()}},{kind:"field",decorators:[(0,b.SB)()],key:"_end",value:function(){return(0,_.p)()}},{kind:"field",decorators:[(0,b.SB)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,b.SB)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,O.t)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],key:"_hiddenStats",value:function(){return[]}},{kind:"field",key:"_untrackedIndex",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,e=this;return[(0,x.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){e._data=t,e._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,Z.SN)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,k.dy)(i||(i=(0,c.Z)([" <ha-card> ",' <div class="content ','"> <ha-chart-base externalHidden .hass="','" .data="','" .extraData="','" .options="','" chart-type="bar" @dataset-hidden="','" @dataset-unhidden="','"></ha-chart-base> </div> </ha-card> '])),this._config.title?(0,k.dy)(s||(s=(0,c.Z)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,y.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._chartDatasetExtra,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,"kWh",this._compareStart,this._compareEnd),this._datasetHidden,this._datasetUnhidden):k.Ld}},{kind:"method",key:"_datasetHidden",value:function(t){var e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=[].concat((0,d.Z)(this._hiddenStats),[e])}},{kind:"method",key:"_datasetUnhidden",value:function(t){var e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=this._hiddenStats.filter((function(t){return t!==e}))}},{kind:"field",key:"_createOptions",value:function(){var t=this;return(0,g.Z)((function(e,a,n,i,s,r,o){var d=(0,E.J)(e,a,n,i,s,r,o);return Object.assign(Object.assign({},d),{},{interaction:{mode:"nearest"},plugins:Object.assign(Object.assign({},d.plugins),{},{legend:{display:!0,labels:{usePointStyle:!0}}}),onClick:function(e,a,n){var i,s,r,o;if(!(0,H.n)(e)){var d=null!==(i=null===(s=a[0])||void 0===s?void 0:s.datasetIndex)&&void 0!==i?i:-1;if(!(d<0)){var c=null===(r=t._data)||void 0===r||null===(r=r.prefs.device_consumption[d])||void 0===r?void 0:r.stat_consumption;c&&!(0,C.Hs)(c)&&((0,D.B)(t,"hass-more-info",{entityId:c}),null==n||null===(o=n.canvas)||void 0===o||o.dispatchEvent(new Event("mouseout")))}}}})}))}},{kind:"method",key:"_processStatistics",value:function(){var t=this._data,e=t.stats,a=t.statsCompare,n=getComputedStyle(this),i={};t.prefs.device_consumption.forEach((function(t){var a=t.stat_consumption in e&&(0,C.Kj)(e[t.stat_consumption])||0;i[t.stat_consumption]=a}));var s=t.prefs.device_consumption.map((function(t){return t.stat_consumption}));s.sort((function(t,e){return i[e]-i[t]}));var r=[],o=[],c=this._processDataSet(n,e,t.statsMetadata,t.prefs.device_consumption,s),u=c.data,l=c.dataExtras;r.push.apply(r,(0,d.Z)(u)),o.push.apply(o,(0,d.Z)(l));var h=(0,x.EH)(t),f=h.summedData,v=h.compareSummedData,p="from_grid"in f||"solar"in f||"from_battery"in f,k=p?(0,x.E4)(f,v):{consumption:void 0,compareConsumption:void 0},b=k.consumption,y=k.compareConsumption;if(p){this._untrackedIndex=r.length;var g=this._processUntracked(n,u,b,!1),m=g.dataset,S=g.datasetExtra;r.push(m),o.push(S)}if(a){r.push({order:0,data:[]}),o.push({show_legend:!1}),r.push({order:999,data:[],xAxisID:"xAxisCompare"}),o.push({show_legend:!1});var w=this._processDataSet(n,a,t.statsMetadata,t.prefs.device_consumption,s,!0),Z=w.data,E=w.dataExtras;if(r.push.apply(r,(0,d.Z)(Z)),o.push.apply(o,(0,d.Z)(E)),p){var D=this._processUntracked(n,Z,y,!0),O=D.dataset,H=D.datasetExtra;r.push(O),o.push(H)}}this._start=t.start,this._end=t.end||(0,_.p)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:r},this._chartDatasetExtra=o}},{kind:"method",key:"_processUntracked",value:function(t,e,a,n){var i={};e.forEach((function(t){t.data.forEach((function(t){i[t.x]=(i[t.x]||0)+t.y}))}));var s=[];return Object.keys(a.total).forEach((function(t){s.push({x:Number(t),y:a.total[t]-(i[t]||0)})})),{dataset:{label:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),hidden:this._hiddenStats.includes("untracked"),borderColor:(0,S.H)(t,this.hass.themes.darkMode,!1,n,"--state-unavailable-color"),backgroundColor:(0,S.H)(t,this.hass.themes.darkMode,!0,n,"--state-unavailable-color"),data:s,order:1+this._untrackedIndex,stack:"devices",pointStyle:!n&&"circle",xAxisID:n?"xAxisCompare":void 0},datasetExtra:{show_legend:!n}}}},{kind:"method",key:"_processDataSet",value:function(t,e,a,n,i){var s=this,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],d=[],c=[];return n.forEach((function(n,u){var l,h=(0,m.hZ)(u,t),f=null,v=[];if(n.stat_consumption in e){var p,_,k=e[n.stat_consumption],b=(0,o.Z)(k);try{for(b.s();!(_=b.n()).done;){var y=_.value;if(null!==y.change&&void 0!==y.change&&f!==y.start){var g=new Date(y.start);v.push({x:g.getTime(),y:y.change}),f=y.start,p=y.end}}}catch(w){b.e(w)}finally{b.f()}1===v.length&&v.push({x:p,y:0})}var S=i.indexOf(n.stat_consumption),x=!!(null!==(l=s._config)&&void 0!==l&&l.max_devices&&S>=s._config.max_devices);d.push({label:n.name||(0,C.Kd)(s.hass,n.stat_consumption,a[n.stat_consumption]),hidden:s._hiddenStats.includes(n.stat_consumption)||x,borderColor:r?h+"7F":h,backgroundColor:r?h+"32":h+"7F",data:v,order:1+S,stack:"devices",pointStyle:!r&&"circle",xAxisID:r?"xAxisCompare":void 0}),c.push({show_legend:!r&&!x})})),{data:d,dataExtras:c}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,k.iv)(r||(r=(0,c.Z)([".card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}"])))}}]}}),(0,w.f)(k.oi));n()}catch(P){n(P)}}))}}]);
//# sourceMappingURL=63697.7329d77ada6e6bde.js.map