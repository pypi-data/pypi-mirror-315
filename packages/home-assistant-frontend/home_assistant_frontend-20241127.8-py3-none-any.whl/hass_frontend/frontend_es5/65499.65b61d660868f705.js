"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["65499"],{32972:function(e,t,n){n.d(t,{x:function(){return i}});var i=function(e,t){return e.substring(0,t.length)===t}},65354:function(e,t,n){n.d(t,{U:function(){return h}});n(71695),n(11907),n(42713),n(99341),n(47021);var i=n(50875),r=n(11259),o=n(4643),a=n(73850),s=n(42818),c=n(96194),d=n(76190),l={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};var u=0,_=new Map;function h(e,t,n){return function(e,t,n){var i;if(!n||e===c.nZ)return(0,d.g)("--history-unavailable-color",t);if(e===c.lz)return(0,d.g)("--history-unknown-color",t);var u=(0,s.tD)(n,e);if(u){var _=(0,d.g)(u,t);if(_){var h=(0,a.M)(n.entity_id),v=null===(i=l[h])||void 0===i?void 0:i[e];return v?(0,r.uO)((0,o.C)((0,r.Rw)((0,r.wK)(_)),v)):_}}}(e,t,n)||function(e,t){if(_.has(e))return _.get(e);var n=(0,i.hZ)(u,t);return u++,_.set(e,n),n}(e,t)}},49277:function(e,t,n){n.d(t,{sS:function(){return g},ri:function(){return b},hb:function(){return p},Yc:function(){return m},jV:function(){return h},o1:function(){return f},MY:function(){return k}});var i,r=n("9833"),o=n("94524"),a=(n("38419"),n("52961"),n("42713"),n("40251"),n("19134"),n("11740"),n("97003"),n("88044"),n("73358")),s=n("73850"),c=n("59847"),d=n("87733"),l=function(e,t){return function(e){switch(e){case"de":case"lb":return!0;default:return!1}}(t)?(0,d.f)(e):e.toLocaleLowerCase(t)},u=n("96194"),_="ui.components.logbook.messages",h=["counter","proximity","sensor","zone"],v={triggered_by_numeric_state_of:"numeric state of",triggered_by_state_of:"state of",triggered_by_event:"event",triggered_by_time_pattern:"time pattern",triggered_by_time:"time",triggered_by_homeassistant_stopping:"Home Assistant stopping",triggered_by_homeassistant_starting:"Home Assistant starting"},g=99387==n.j?(i=(0,o.Z)((0,r.Z)().mark((function e(t,n,i){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y(t,n,void 0,void 0,i));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return i.apply(this,arguments)}):null,y=function(e,t,n,i,r,o){if((i||o)&&(!i||0===i.length)&&(!o||0===o.length))return Promise.resolve([]);var a={type:"logbook/get_events",start_time:t};return n&&(a.end_time=n),null!=i&&i.length&&(a.entity_ids=i),null!=o&&o.length&&(a.device_ids=o),r&&(a.context_id=r),e.callWS(a)},m=function(e,t,n,i,r,o){if((r||o)&&(!r||0===r.length)&&(!o||0===o.length))return Promise.reject("No entities or devices");var a={type:"logbook/event_stream",start_time:n,end_time:i};return null!=r&&r.length&&(a.entity_ids=r),null!=o&&o.length&&(a.device_ids=o),e.connection.subscribeMessage((function(e){return t(e)}),a)},f=function(e,t){return{entity_id:e.entity_id,state:t,attributes:{device_class:null==e?void 0:e.attributes.device_class,source_type:null==e?void 0:e.attributes.source_type,has_date:null==e?void 0:e.attributes.has_date,has_time:null==e?void 0:e.attributes.has_time,entity_picture_local:a.iY.has((0,s.M)(e.entity_id))||null==e?void 0:e.attributes.entity_picture_local,entity_picture:a.iY.has((0,s.M)(e.entity_id))||null==e?void 0:e.attributes.entity_picture}}},p=function(e,t){for(var n=0,i=Object.keys(v);n<i.length;n++){var r=i[n],o=v[r];if(t.startsWith(o))return t.replace(o,"".concat(e("ui.components.logbook.".concat(r))))}return t},b=function(e,t,n,i,r){switch(r){case"device_tracker":case"person":return"not_home"===n?t("".concat(_,".was_away")):"home"===n?t("".concat(_,".was_at_home")):t("".concat(_,".was_at_state"),{state:n});case"sun":return t("".concat(_,"above_horizon"===n?".rose":".set"));case"binary_sensor":var o=n===a.uo,s=n===a.lC,c=i.attributes.device_class;if(c&&(o||s))return t("".concat(_,".").concat(o?"detected_device_classes":"cleared_device_classes",".").concat(c),{device_class:l(t("component.binary_sensor.entity_component.".concat(c,".name"))||c,e.language)})||t("".concat(_,".").concat(o?"detected_device_class":"cleared_device_class"),{device_class:l(t("component.binary_sensor.entity_component.".concat(c,".name"))||c,e.language)});break;case"cover":switch(n){case"open":return t("".concat(_,".was_opened"));case"opening":return t("".concat(_,".is_opening"));case"closing":return t("".concat(_,".is_closing"));case"closed":return t("".concat(_,".was_closed"))}break;case"event":return t("".concat(_,".detected_event_no_type"));case"lock":switch(n){case"unlocked":return t("".concat(_,".was_unlocked"));case"locking":return t("".concat(_,".is_locking"));case"unlocking":return t("".concat(_,".is_unlocking"));case"opening":return t("".concat(_,".is_opening"));case"open":return t("".concat(_,".is_opened"));case"locked":return t("".concat(_,".was_locked"));case"jammed":return t("".concat(_,".is_jammed"))}}return n===a.uo?t("".concat(_,".turned_on")):n===a.lC?t("".concat(_,".turned_off")):n===u.lz?t("".concat(_,".became_unknown")):n===u.nZ?t("".concat(_,".became_unavailable")):e.localize("".concat(_,".changed_to_state"),{state:i?e.formatEntityState(i,n):n})},k=function(e){return"sensor"!==(0,c.N)(e)||void 0===e.attributes.unit_of_measurement&&void 0===e.attributes.state_class}},75244:function(e,t,n){n.d(t,{U_:function(){return s},Zm:function(){return d},lj:function(){return a},mA:function(){return o},nV:function(){return c}});n(52247),n(18801),n(61495),n(23509),n(52961),n(42713),n(39527),n(67670);if(99387==n.j)var i=n(32972);var r=n(14473),o=function(e,t,n,i){return e.callWS({type:"trace/get",domain:t,item_id:n,run_id:i})},a=function(e,t,n){return e.callWS({type:"trace/list",domain:t,item_id:n})},s=function(e,t,n){return e.callWS({type:"trace/contexts",domain:t,item_id:n})},c=function(e,t){for(var n=t.split("/").reverse(),i=e;n.length;){var o=n.pop(),a=Number(o);if(isNaN(a)){var s=i[o];if(!s&&"sequence"===o)continue;s||"trigger"!==o||(s=i.triggers),s||"condition"!==o||(s=i.conditions),s||"action"!==o||(s=i.actions),i="trigger"===o?(0,r.Kc)(s):s}else if(Array.isArray(i))i=i[a];else if(0!==a)throw new Error("If config is not an array, can only return index 0")}return i},d=function(e){return"trigger"===e||(0,i.x)(e,"trigger/")}},82480:function(e,t,n){n.a(e,(async function(e,t){try{var i,r,o,a,s,c,d,l,u,_,h,v,g,y,m,f,p,b,k=n(63038),x=n(27862),w=n(52565),z=n(92776),C=n(5776),Z=n(21475),I=(n(38419),n(19083),n(80133),n(71695),n(83069),n(64228),n(92745),n(22879),n(63619),n(42713),n(19134),n(97499),n(61006),n(97003),n(13334),n(47021),n(57243)),M=n(50778),E=n(35359),S=n(69634),j=n(72344),B=n(46467),L=n(33570),P=n(31146),N=n(36522),U=n(73850),W=n(83523),T=n(65354),D=n(5460),O=(n(97206),n(13928),n(95975)),A=n(49277),V=n(28008),Y=n(47641),$=n(88238),F=n(57816),H=e([D,O,B,L]);[D,O,B,L]=H.then?(await H)():H;var K=["script","automation"];(0,Z.Z)([(0,M.Mo)("ha-logbook-renderer")],(function(e,t){var n=function(t){function n(){var t;(0,w.Z)(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t=(0,z.Z)(this,n,[].concat(r)),e(t),t}return(0,C.Z)(n,t),(0,x.Z)(n)}(t);return{F:n,d:[{kind:"field",decorators:[(0,M.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,M.Cb)({attribute:!1})],key:"userIdToName",value:function(){return{}}},{kind:"field",decorators:[(0,M.Cb)({attribute:!1})],key:"traceContexts",value:function(){return{}}},{kind:"field",decorators:[(0,M.Cb)({attribute:!1})],key:"entries",value:function(){return[]}},{kind:"field",decorators:[(0,M.Cb)({type:Boolean,attribute:"narrow"})],key:"narrow",value:function(){return!1}},{kind:"field",decorators:[(0,M.Cb)({type:Boolean,attribute:"virtualize",reflect:!0})],key:"virtualize",value:function(){return!1}},{kind:"field",decorators:[(0,M.Cb)({type:Boolean,attribute:"show-indicator"})],key:"showIndicator",value:function(){return!1}},{kind:"field",decorators:[(0,M.Cb)({type:Boolean,attribute:"no-icon"})],key:"noIcon",value:function(){return!1}},{kind:"field",decorators:[(0,M.Cb)({type:Boolean,attribute:"no-name"})],key:"noName",value:function(){return!1}},{kind:"field",decorators:[(0,M.Cb)({type:Boolean,attribute:"relative-time"})],key:"relativeTime",value:function(){return!1}},{kind:"field",decorators:[(0,P.i)(".container")],key:"_savedScrollPos",value:void 0},{kind:"method",key:"willUpdate",value:function(e){(!this.hasUpdated&&this.virtualize||e.has("virtualize")&&this.virtualize)&&(this.hass.loadBackendTranslation("services"),this.hass.loadBackendTranslation("title"),(0,Y.o)())}},{kind:"method",key:"shouldUpdate",value:function(e){var t=e.get("hass"),n=void 0===t||t.locale!==this.hass.locale;return e.has("entries")||e.has("traceContexts")||n}},{kind:"method",key:"render",value:function(){var e,t=this;return null!==(e=this.entries)&&void 0!==e&&e.length?(0,I.dy)(r||(r=(0,k.Z)([' <div class="container ha-scrollbar ','" @scroll="','"> '," </div> "])),(0,E.$)({narrow:this.narrow,"no-name":this.noName,"no-icon":this.noIcon}),this._saveScrollPos,this.virtualize?(0,I.dy)(o||(o=(0,k.Z)(['<lit-virtualizer @visibilityChanged="','" scroller class="ha-scrollbar" .items="','" .renderItem="','"> </lit-virtualizer>'])),this._visibilityChanged,this.entries,this._renderLogbookItem):this.entries.map((function(e,n){return t._renderLogbookItem(e,n)}))):(0,I.dy)(i||(i=(0,k.Z)([' <div class="container no-entries"> '," </div> "])),this.hass.localize("ui.components.logbook.entries_not_found"))}},{kind:"field",key:"_renderLogbookItem",value:function(){var e=this;return function(t,n){var i;if(!t||void 0===n)return I.Ld;var r=e.entries[n-1],o=[],u=t.entity_id?e.hass.states[t.entity_id]:void 0,_=u?(0,A.o1)(u,t.state):void 0,h=t.entity_id?(0,U.M)(t.entity_id):t.domain,v=_||t.icon||t.state||!h||!(0,j.p)(e.hass,h)?void 0:(0,$.X1)({domain:h,type:"icon",useFallback:!0,darkOptimized:null===(i=e.hass.themes)||void 0===i?void 0:i.darkMode}),g=K.includes(t.domain)&&t.context_id in e.traceContexts?e.traceContexts[t.context_id]:void 0,y=void 0!==g;return(0,I.dy)(a||(a=(0,k.Z)([' <div class="entry-container ','" .traceLink="','" @click="','"> ',' <div class="entry ','"> <div class="icon-message"> '," ",' <div class="message-relative_time"> <div class="message"> '," "," ",' </div> <div class="secondary"> <span>','</span> - <ha-relative-time .hass="','" .datetime="','" capitalize></ha-relative-time> '," "," </div> </div> </div> "," </div> </div> "])),(0,E.$)({clickable:y}),g?"/config/".concat(g.domain,"/trace/").concat(g.item_id,"?run_id=").concat(g.run_id):void 0,e._handleClick,0===n||null!=t&&t.when&&null!=r&&r.when&&new Date(1e3*t.when).toDateString()!==new Date(1e3*r.when).toDateString()?(0,I.dy)(s||(s=(0,k.Z)([' <h4 class="date"> '," </h4> "])),(0,B.p6)(new Date(1e3*t.when),e.hass.locale,e.hass.config)):I.Ld,(0,E.$)({"no-entity":!t.entity_id}),e.noIcon?"":(0,I.dy)(c||(c=(0,k.Z)([' <state-badge .hass="','" .overrideIcon="','" .overrideImage="','" .stateObj="','" .stateColor="','"></state-badge> '])),e.hass,t.icon,v,t.icon?void 0:_,!1),e.showIndicator?e._renderIndicator(t):"",e.noName?"":e._renderEntity(t.entity_id,t.name,y),e._renderMessage(t,o,h,_,y),e._renderContextMessage(t,o,y),(0,L.Vu)(new Date(1e3*t.when),e.hass.locale,e.hass.config),e.hass,1e3*t.when,t.context_user_id?(0,I.dy)(d||(d=(0,k.Z)(["",""])),e._renderUser(t)):"",y?"- ".concat(e.hass.localize("ui.components.logbook.show_trace")):"",y?(0,I.dy)(l||(l=(0,k.Z)(["<ha-icon-next></ha-icon-next>"]))):"")}}},{kind:"method",decorators:[(0,M.hO)({passive:!0})],key:"_saveScrollPos",value:function(e){this._savedScrollPos=e.target.scrollTop}},{kind:"method",decorators:[(0,M.hO)({passive:!0})],key:"_visibilityChanged",value:function(e){(0,N.B)(this,"hass-logbook-live",{enable:0===e.first})}},{kind:"method",key:"_renderIndicator",value:function(e){var t=this.hass.states[e.entity_id],n=getComputedStyle(this),i={backgroundColor:void 0!==e.state?(0,T.U)(e.state,n,t):void 0};return(0,I.dy)(u||(u=(0,k.Z)([' <div class="indicator" style="','"></div> '])),(0,S.V)(i))}},{kind:"method",key:"_renderMessage",value:function(e,t,n,i,r){if(e.entity_id&&e.state)return i?(0,A.ri)(this.hass,this.hass.localize,e.state,i,n):e.state;var o=function(e){return e.context_event_type||e.context_state||e.context_message}(e),a=e.message;if(K.includes(n)&&e.source){if(o)return"";a=(0,A.hb)(this.hass.localize,e.source)}return a?this._formatMessageWithPossibleEntity(o?function(e,t){return t?e.replace(t," "):e}(a,e.context_entity_id):a,t,void 0,r):""}},{kind:"method",key:"_renderUser",value:function(e){var t=e.context_user_id&&this.userIdToName[e.context_user_id];return t?"- ".concat(t):""}},{kind:"method",key:"_renderUnseenContextSourceEntity",value:function(e,t,n){return!e.context_entity_id||t.includes(e.context_entity_id)?"":(0,I.dy)(_||(_=(0,k.Z)([" (",")"])),this._renderEntity(e.context_entity_id,e.context_entity_id_name,n))}},{kind:"method",key:"_renderContextMessage",value:function(e,t,n){if(e.context_state){var i=e.context_entity_id&&e.context_entity_id in this.hass.states?(0,A.o1)(this.hass.states[e.context_entity_id],e.context_state):void 0;return(0,I.dy)(h||(h=(0,k.Z)([""," "," ",""])),this.hass.localize("ui.components.logbook.triggered_by_state_of"),this._renderEntity(e.context_entity_id,e.context_entity_id_name,n),i?(0,A.ri)(this.hass,this.hass.localize,e.context_state,i,(0,U.M)(e.context_entity_id)):e.context_state)}var r;if("call_service"===e.context_event_type)return(0,I.dy)(v||(v=(0,k.Z)([""," ",""])),this.hass.localize("ui.components.logbook.triggered_by_action"),e.context_domain&&e.context_service?"".concat((0,F.Lh)(this.hass.localize,e.context_domain),":\n      ").concat(this.hass.localize("component.".concat(e.context_domain,".services.").concat(e.context_service,".name"))||(null===(r=this.hass.services[e.context_domain])||void 0===r||null===(r=r[e.context_service])||void 0===r?void 0:r.name)||e.context_service):"");if(!e.context_message||t.includes(e.context_entity_id))return"";if("automation_triggered"===e.context_event_type||"script_started"===e.context_event_type){var o=e.context_source?e.context_source:e.context_message.replace("triggered by ",""),a=(0,A.hb)(this.hass.localize,o);return(0,I.dy)(g||(g=(0,k.Z)([""," "," ",""])),this.hass.localize("automation_triggered"===e.context_event_type?"ui.components.logbook.triggered_by_automation":"ui.components.logbook.triggered_by_script"),this._renderEntity(e.context_entity_id,e.context_entity_id_name,n),e.context_message?this._formatMessageWithPossibleEntity(a,t,void 0,n):"")}return(0,I.dy)(y||(y=(0,k.Z)([" "," "," "," ",""])),this.hass.localize("ui.components.logbook.triggered_by"),e.context_name,this._formatMessageWithPossibleEntity(e.context_message,t,e.context_entity_id,n),this._renderUnseenContextSourceEntity(e,t,n))}},{kind:"method",key:"_renderEntity",value:function(e,t,n){var i=e&&e in this.hass.states,r=t||i&&this.hass.states[e].attributes.friendly_name||e;return i?n?r:(0,I.dy)(m||(m=(0,k.Z)(['<button class="link" @click="','" .entityId="','"> '," </button>"])),this._entityClicked,e,r):r}},{kind:"method",key:"_formatMessageWithPossibleEntity",value:function(e,t,n,i){if(-1!==e.indexOf("."))for(var r=e.split(" "),o=0,a=r.length;o<a;o++)if(r[o]in this.hass.states){var s=r[o];if(t.includes(s))return"";t.push(s);var c=r.splice(o);return c.shift(),(0,I.dy)(f||(f=(0,k.Z)([""," "," ",""])),r.join(" "),this._renderEntity(s,this.hass.states[s].attributes.friendly_name,i),c.join(" "))}if(n&&n in this.hass.states){var d=this.hass.states[n].attributes.friendly_name;if(d&&e.endsWith(d))return t.includes(n)?"":(t.push(n),e=e.substring(0,e.length-d.length),(0,I.dy)(p||(p=(0,k.Z)([""," ",""])),e,this._renderEntity(n,d,i)))}return e}},{kind:"method",key:"_entityClicked",value:function(e){var t=e.currentTarget.entityId;t&&(e.preventDefault(),e.stopPropagation(),(0,N.B)(this,"hass-more-info",{entityId:t}))}},{kind:"method",key:"_handleClick",value:function(e){e.currentTarget.traceLink&&((0,W.c)(e.currentTarget.traceLink),(0,N.B)(this,"closed"))}},{kind:"get",static:!0,key:"styles",value:function(){return[V.Qx,V.$c,V.k1,(0,I.iv)(b||(b=(0,k.Z)([":host([virtualize]){display:block;height:100%}.entry-container{width:100%}.entry{position:relative;display:flex;width:100%;line-height:2em;padding:8px 16px;box-sizing:border-box;border-top:1px solid var(--divider-color);justify-content:space-between;align-items:center}.indicator{background-color:var(--disabled-color);height:8px;width:8px;border-radius:4px;flex-shrink:0;margin-right:12px;margin-inline-start:initial;margin-inline-end:12px;direction:var(--direction)}ha-icon-next{color:var(--secondary-text-color)}.clickable{cursor:pointer}:not(.clickable) .entry.no-entity,:not(.clickable) .no-name .entry{cursor:default}.entry:hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.narrow:not(.no-icon) .time{margin-left:32px;margin-inline-start:32px;margin-inline-end:initial;direction:var(--direction)}.message-relative_time{display:flex;flex-direction:column}.secondary{font-size:12px;line-height:1.7}.secondary a{color:var(--secondary-text-color)}.date{margin:8px 0;padding:0 16px}.icon-message{display:flex;align-items:center}.no-entries{text-align:center;color:var(--secondary-text-color)}state-badge{margin-right:16px;margin-inline-start:initial;flex-shrink:0;color:var(--state-icon-color);margin-inline-end:16px;direction:var(--direction)}.message{color:var(--primary-text-color)}.no-name .message:first-letter{text-transform:capitalize}a{color:var(--primary-color);text-decoration:none}button.link{color:var(--paper-item-icon-color);text-decoration:none}.container{max-height:var(--logbook-max-height)}.container,lit-virtualizer{height:100%}lit-virtualizer{contain:size layout!important}.narrow .entry{line-height:1.5}.narrow .icon-message state-badge{margin-left:0;margin-inline-start:0;margin-right:8px;margin-inline-end:8px;direction:var(--direction)}"])))]}}]}}),I.oi);t()}catch(q){t(q)}}))}}]);
//# sourceMappingURL=65499.65b61d660868f705.js.map