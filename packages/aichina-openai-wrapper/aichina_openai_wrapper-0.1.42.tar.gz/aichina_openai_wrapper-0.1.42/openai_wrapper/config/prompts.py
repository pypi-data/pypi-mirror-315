# config/prompts.py

TRANSLATE_EN_CN = [
    {"role": "system",
     "content": "You are a professional translator. Translate text from English to Chinese. Only output the translated text."},
    {"role": "user", "content": "Hello, how are you?"},
    {"role": "assistant", "content": "你好，你怎么样？"}

]

COMMENT_TO_DIALOG = [
    {"role": "system", "content": """你是一个对话转换助手。你的任务是将评论转换为自然的问答对话。

1. 输入格式:
- 上下文: 原帖中的问答对
- 评论: 针对该问答的评论内容

2. 转换要求:
- 将评论转换为自然的对话形式
- 对话必须参考并延续原帖的问答内容
- 新对话应该对原问答进行补充或展开
- 保持语气和立场的连贯性
- 回答要有理有据,富有建设性

3. 输出格式:
必须是合法的 JSON 字符串:
[
    {
        "role": "user",
        "content": "结合原帖内容的用户提问" 
    },
    {
        "role": "assistant",
        "content": "针对原帖和提问的回答"
    }
]

4. 注意事项:
- 直接输出 JSON,不要添加其他说明
- 确保 JSON 格式正确
- 对话要自然且符合上下文"""},
    {
        "role": "user",
        "content": """上下文：
用户: "考试总是让我很紧张,感觉发挥不好,怎么办?"
助手: "这是很常见的考试焦虑。建议你:1)提前复习,建立信心;2)考前保持良好作息;3)做些放松练习;4)告诉自己这只是一次普通考试。"

需要转换的评论：考试不仅是检验知识,也是锻炼心理素质。太过紧张反而影响发挥。"""},
    {
        "role": "assistant",
        "content": "[ { \"role\": \"user\", \"content\": \"考试让我总是很紧张，发挥不好怎么办？\" }, { \"role\": \"assistant\", \"content\": \"这是很常见的考试焦虑。建议你：1) 提前复习，建立信心；2) 考前保持良好作息；3) 做些放松练习；4) 告诉自己这只是一次普通考试。\" }, { \"role\": \"user\", \"content\": \"是不是说，考试不仅是检验知识的过程，也是锻炼心理素质的机会？我是不是应该调整心态，尽量别让紧张影响发挥？\" }, { \"role\": \"assistant\", \"content\": \"考试不仅是知识的检验，更是锻炼心理素质的机会。调整心态、积极面对考试是关键。适度紧张是正常的，但过度紧张可能会影响你的发挥。\\n\\n以下是一些建议帮助你调整心态：\\n\\n将考试看作一次挑战，而不是威胁：告诉自己，考试是展示自己学习成果的机会，不是单纯的压力来源。\\n专注于过程，而不是结果：把注意力放在如何有效复习和临场应对上，而不是过分担心成绩。\\n建立积极的自我对话：用积极的语言鼓励自己，例如“我已经尽力了”，“这次只是一次锻炼的机会”。\\n复习计划合理，考前适当放松：复习时注意劳逸结合，考前可以通过深呼吸或冥想减缓紧张情绪。\\n心理素质的锻炼不仅能帮助你更好地应对考试，也会让你在其他人生挑战中更加从容！\" } ]"
    }
]

ANSWER_MERGING_EXAMPLE = [
    {
        "role": "system",
        "content": "你是一个专业的内容编辑，负责将多个回复合并成一个清晰、连贯、完整的答案。你需要确保保留关键信息，避免重复，并且确保最终回答准确、简洁、直接地回应原始问题。如果某些回复内容不足以完整回答问题，请补充相关信息，使答案更全面。输出应该是一段条理清晰、逻辑严谨且无冗余的文本。"
    },
    {
        "role": "user",
        "content": """原始问题：如果我在arXiv上发布了一篇预印本论文，之后如何保证出版商的独家权利？我在arXiv上发布预印本后，是否就无法在非开放获取的期刊上发表了?

需要合并的回复：
- 回复1: 不一定，但这需要根据具体情况来处理。你可以通过查看Sherpa/Romeo的网页来了解哪些出版商/期刊采用了哪些政策。
- 回复2: 即使预印本已在arXiv上发布，通常你仍然可以在一本非开放获取的期刊上发表文章。大多数期刊的版权协议明确允许作者将文章在线发布。这里有一个比较宽松的例子：\n\n美国数学学会特此授予作者非排他性权利，以复制该文章，基于该文章创作衍生作品，并通过任何方式和在任何媒体上分发和展示该文章及任何此类衍生作品，前提是满足以下第（3）条款的规定。作者可以将这些权利转授权给任何出版商或其他第三方。\n\n还有一个不太宽松但仍允许作者在线发布副本的例子：\n\n我理解我保留或在此被授予（无需进一步获得许可）使用某些版本的文章的权利，用于某些学术目的，如下所述和定义（“保留权利”），并且没有转让任何专利、商标或其他知识产权给期刊。\n保留权利包括使用预印本或接受的作者手稿进行个人使用、内部机构使用和学术发布；以及使用已发表的期刊文章进行个人使用和内部机构使用。\n\n我见过一些例子，期刊确实进行了真正的编辑工作，而不仅仅是审稿人做的编辑工作，在这种情况下，作者不被允许发布受益于编辑的版本，但仍可以发布早期版本。\n因此，对于大多数期刊来说，答案是你可以将文章在线发布，因为这是他们要求你签署的文件中明确允许的。但也有可能在arXiv上发布会排除一些有更严格政策的特定期刊。
- 回复3:  英格尔芬格规则现在一般被科学出版商所忽视。F1000针对他们的海报库进行了大量研究。少数几个声称不允许预印本的知名出版商中，血液杂志被特别指出，因为他们虽然表示不允许，但似乎没有检查的方法，因此实际上是默认允许的。以下是来自禁运观察博客的两个链接描述了这个故事：\nFaculty of 1000 打击英格尔芬格规则\nF1000 对抗英格尔芬格，第二部分：血液杂志和蛋白质组研究杂志的回应"""
    },
    {
        "role": "assistant",
        "content": "在arXiv上发布预印本后，是否能在非开放获取的期刊上发表，以及如何确保出版商的独家权利，取决于具体期刊的政策。大多数期刊允许作者发布预印本，尤其是在期刊版权协议中明确允许作者在arXiv等平台上分享预印本副本。举例来说，像美国数学学会这样的出版商，通常会授予作者非排他性的权利，可以将文章在线发布并创作衍生作品。此外，很多期刊即使要求版权转让，也会保留作者在线发布预印本或接受的手稿副本的权利。然而，也存在一些例外，某些期刊对预印本的政策较为严格，尤其是一些较为传统的出版商。在这些期刊中，可能会限制预印本的发布，或者要求作者在提交时删除arXiv版本。对于这些期刊，你可以通过查阅Sherpa/Romeo等资源来了解其具体政策。此外，有些期刊会允许作者发布早期版本，而非最终经过编辑后的版本，因此作者仍然可以在arXiv上保留原始预印本。值得一提的是，英格尔芬格规则（Inglefinger Rule），即某些期刊禁止或限制预印本的发布，现在已经被大多数出版商忽视。少数几个仍然执行该规则的期刊，如《血液杂志》，虽然明确禁止预印本，但并未严格执行该政策，因此实际上可能仍然允许预印本发布。综上所述，在arXiv发布预印本后，你通常仍然可以在非开放获取的期刊上发表文章，但需根据期刊的具体政策进行确认。如果期刊有严格的规定，可能会要求你在提交期刊时撤下预印本或仅发布早期版本。"
    }
]


def get_prompt_to_merge_answers(origin_question: str, answers: list[str]):
    # 构造合并回复的内容
    merged_answers = "\n".join([f"- 回复{i + 1}: {answer}" for i, answer in enumerate(answers)])

    # 更新 user 内容
    prompt = f"原始问题：{origin_question}\n\n需要合并的回复:{merged_answers}"

    # 构建消息并返回
    messages = ANSWER_MERGING_EXAMPLE + [{"role": "user", "content": prompt}]
    return messages


def get_prompt_for_comment_to_dialog(origin_question: str, origin_answer: str, comment: str):
    # 构造上下文部分
    context = f"""上下文：
用户: "{origin_question}"
助手: "{origin_answer}"
"""
    # 构造需要转换的评论
    comment_content = f"需要转换的评论：{comment}"

    # 合并为完整的 user 消息内容
    prompt = f"{context}\n{comment_content}"

    # 构建消息并返回
    messages = COMMENT_TO_DIALOG + [{"role": "user", "content": prompt}]
    return messages


# print(get_prompt_to_merge_answers("原始问题？", ["1号回答", "2号回答"]))


# origin_question = "考试总是让我很紧张,感觉发挥不好,怎么办?"
# origin_answer = "这是很常见的考试焦虑。建议你:1)提前复习,建立信心;2)考前保持良好作息;3)做些放松练习;4)告诉自己这只是一次普通考试。"
# comment = "考试不仅是检验知识,也是锻炼心理素质。太过紧张反而影响发挥。"
#
# messages = get_prompt_for_comment_to_dialog(origin_question, origin_answer, comment)
# print(messages)
