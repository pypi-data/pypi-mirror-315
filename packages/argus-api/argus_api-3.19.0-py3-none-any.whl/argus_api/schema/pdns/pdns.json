{
  "swagger": "2.0",
  "info": {},
  "basePath": "/",
  "tags": [
    {
      "name": "pdns/v3"
    }
  ],
  "paths": {
    "/pdns/v3/cof/{query}": {
      "get": {
        "tags": [
          "pdns/v3"
        ],
        "summary": "Search against PassiveDNS and return matching records in PDNS COF format (PUBLIC)",
        "description": "This endpoint behaves exactly like searchRecordsSimplified, but follows the Passive DNS Common Output Format as specified in Internet Draft draft-dulaunoy-dnsop-passive-dns-cof-06.\nThis means that the return format of this endpoint is a newline-separated list of JSON objects.",
        "operationId": "searchRecordsSimplifiedCOF",
        "produces": [
          "application/json",
          "text/csv"
        ],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": false,
            "type": "string"
          },
          {
            "name": "query",
            "in": "path",
            "description": "Search by query",
            "required": true,
            "type": "string"
          },
          {
            "name": "aggregate",
            "in": "query",
            "description": "Whether aggregate records",
            "required": false,
            "type": "boolean",
            "default": true
          },
          {
            "name": "includeAnonymous",
            "in": "query",
            "description": "Whether include anonymous records",
            "required": false,
            "type": "boolean",
            "default": true
          },
          {
            "name": "rrClass",
            "in": "query",
            "description": "Search by recordClass (rrclass)",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "in"
              ]
            },
            "collectionFormat": "multi"
          },
          {
            "name": "rrType",
            "in": "query",
            "description": "Search by type (rrtype)",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "a",
                "aaaa",
                "cname",
                "dname",
                "mx",
                "naptr",
                "ns",
                "ptr",
                "rp",
                "soa",
                "srv",
                "txt"
              ]
            },
            "collectionFormat": "multi"
          },
          {
            "name": "customerID",
            "in": "query",
            "description": "Search by customerID",
            "required": false,
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int64"
            },
            "collectionFormat": "multi"
          },
          {
            "name": "tlp",
            "in": "query",
            "description": "Search by TLP",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "white",
                "green",
                "amber",
                "red"
              ]
            },
            "collectionFormat": "multi"
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Skip a number of records",
            "required": false,
            "type": "integer",
            "default": 0,
            "minimum": 0,
            "format": "int32"
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Max number of records to be returned",
            "required": false,
            "type": "integer",
            "default": 25,
            "minimum": 0,
            "format": "int32"
          },
          {
            "name": "queryMatchStrategy",
            "in": "query",
            "description": "Query match strategy, partial must be set to use the wildcard",
            "required": false,
            "type": "string",
            "enum": [
              "exact",
              "includeSubdomains"
            ]
          }
        ],
        "responses": {
          "401": {
            "description": "Authentication failed"
          },
          "402": {
            "description": "Resource limit exceeded"
          },
          "403": {
            "description": "Access denied"
          },
          "412": {
            "description": "Validation failed"
          }
        }
      }
    },
    "/pdns/v3/search": {
      "post": {
        "tags": [
          "pdns/v3"
        ],
        "summary": "Search against PassiveDNS with criteria and return matching records (PUBLIC)",
        "description": "Search against PassiveDNS with criteria and return matching records. If user exceeds current resource limits, this operation may return status code 402. If that happens, the metaData key millisUntilResourcesAvailable gives a hint as to how long the client needs to wait before attempting again. The results are sorted based on the lastSeenTimestamp in descending order.",
        "operationId": "searchRecords",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json",
          "text/csv"
        ],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": false,
            "type": "string"
          },
          {
            "in": "body",
            "name": "body",
            "required": false,
            "schema": {
              "$ref": "#/definitions/no.mnemonic.jargus.criteria.reputation.PassiveDNSSearchCriteriaV1"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "schema": {
              "$ref": "#/definitions/ResultStash-no.mnemonic.jargus.model.passivedns.PassiveDNSRecordV3-list"
            }
          },
          "401": {
            "description": "Authentication failed"
          },
          "402": {
            "description": "Resource limit exceeded."
          },
          "403": {
            "description": "Access denied"
          },
          "412": {
            "description": "Validation failed"
          }
        }
      }
    },
    "/pdns/v3/{query}": {
      "get": {
        "tags": [
          "pdns/v3"
        ],
        "summary": "Search against PassiveDNS and return matching records (PUBLIC)",
        "description": "Search against PassiveDNS with criteria and return matching records. If user exceeds current resource limits, this operation may return status code 402. If that happens, the metaData key millisUntilResourcesAvailable gives a hint as to how long the client needs to wait before attempting again. The results are sorted based on the lastSeenTimestamp in descending order.",
        "operationId": "searchRecordsSimplified",
        "produces": [
          "application/json",
          "text/csv"
        ],
        "parameters": [
          {
            "name": "Accept",
            "in": "header",
            "required": false,
            "type": "string"
          },
          {
            "name": "query",
            "in": "path",
            "description": "Search by query",
            "required": true,
            "type": "string"
          },
          {
            "name": "aggregate",
            "in": "query",
            "description": "Whether aggregate records",
            "required": false,
            "type": "boolean",
            "default": true
          },
          {
            "name": "includeAnonymous",
            "in": "query",
            "description": "Whether include anonymous records",
            "required": false,
            "type": "boolean",
            "default": true
          },
          {
            "name": "rrClass",
            "in": "query",
            "description": "Search by recordClass (rrclass)",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "in"
              ]
            },
            "collectionFormat": "multi"
          },
          {
            "name": "rrType",
            "in": "query",
            "description": "Search by type (rrtype)",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "a",
                "aaaa",
                "cname",
                "dname",
                "mx",
                "naptr",
                "ns",
                "ptr",
                "rp",
                "soa",
                "srv",
                "txt"
              ]
            },
            "collectionFormat": "multi"
          },
          {
            "name": "customerID",
            "in": "query",
            "description": "Search by customerID",
            "required": false,
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int64"
            },
            "collectionFormat": "multi"
          },
          {
            "name": "tlp",
            "in": "query",
            "description": "Search by TLP",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "white",
                "green",
                "amber",
                "red"
              ]
            },
            "collectionFormat": "multi"
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Skip a number of records",
            "required": false,
            "type": "integer",
            "default": 0,
            "minimum": 0,
            "format": "int32"
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Max number of records to be returned",
            "required": false,
            "type": "integer",
            "default": 25,
            "minimum": 0,
            "format": "int32"
          },
          {
            "name": "queryMatchStrategy",
            "in": "query",
            "description": "Query match strategy, partial must be set to use the wildcard",
            "required": false,
            "type": "string",
            "enum": [
              "exact",
              "includeSubdomains"
            ]
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "schema": {
              "$ref": "#/definitions/ResultStash-no.mnemonic.jargus.model.passivedns.PassiveDNSRecordV3-list"
            }
          },
          "401": {
            "description": "Authentication failed"
          },
          "402": {
            "description": "Resource limit exceeded"
          },
          "403": {
            "description": "Access denied"
          },
          "412": {
            "description": "Validation failed"
          }
        }
      }
    },
    "/pdns/v3/{query}/seen": {
      "get": {
        "tags": [
          "pdns/v3"
        ],
        "summary": "Search against PassiveDNS and return true if matching records are found (PUBLIC)",
        "description": "Search against PassiveDNS and return true if matching records are found. If user exceeds current resource limits, this operation may return status code 402. If that happens, the metaData key millisUntilResourcesAvailable gives a hint as to how long the client needs to wait before attempting again.",
        "operationId": "existsRecordsOfTlpLevels",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "query",
            "in": "path",
            "description": "Search by query, can be IP, not subnet, or domain",
            "required": true,
            "type": "string"
          },
          {
            "name": "tlp",
            "in": "query",
            "description": "Search by TLP",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "default": "white",
              "enum": [
                "white",
                "green",
                "amber",
                "red"
              ]
            },
            "collectionFormat": "multi"
          },
          {
            "name": "ignoreOwnRecords",
            "in": "query",
            "description": "Whether to ignore user's customer's own records, defaults to true",
            "required": false,
            "type": "boolean",
            "default": true
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "schema": {
              "$ref": "#/definitions/ResultStash-no.mnemonic.services.pdns.spi.response.PDNSExistsRecordsResponse-single"
            }
          },
          "401": {
            "description": "Authentication failed"
          },
          "402": {
            "description": "Resource limit exceeded"
          },
          "403": {
            "description": "Access denied"
          },
          "412": {
            "description": "Validation failed"
          }
        }
      }
    },
    "/pdns/v3/record": {
      "post": {
        "tags": [
          "pdns/v3"
        ],
        "summary": "Submit PassiveDNS records in a bulk operation (INTERNAL)",
        "description": "",
        "operationId": "submitPDNSRecordsBulk",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "PDNS bulk submission request",
            "required": false,
            "schema": {
              "$ref": "#/definitions/no.mnemonic.services.pdns.spi.request.PDNSBulkSubmissionRequest"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "schema": {
              "$ref": "#/definitions/ResultStash-no.mnemonic.services.pdns.spi.response.PDNSBulkSubmissionResponse-single"
            }
          },
          "401": {
            "description": "Authentication failed"
          },
          "403": {
            "description": "Access denied"
          },
          "412": {
            "description": "Validation failed"
          }
        }
      }
    }
  },
  "definitions": {
    "no.mnemonic.services.argus.common.rest.model.ResultStash": {
      "properties": {
        "responseCode": {
          "type": "integer",
          "format": "int32",
          "description": "Status code returned from API"
        },
        "limit": {
          "type": "integer",
          "format": "int64",
          "description": "Maximum number of returned results"
        },
        "offset": {
          "type": "integer",
          "format": "int64",
          "description": "Number of skipped results"
        },
        "count": {
          "type": "integer",
          "format": "int64",
          "description": "Number of available results on server"
        },
        "size": {
          "type": "integer",
          "format": "int64",
          "description": "Actual number of returned results"
        },
        "metaData": {
          "type": "object",
          "description": "Additional unstructured meta data associated with response"
        },
        "messages": {
          "type": "array",
          "description": "Contains messages returned from the API, usually error messages",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.argus.common.rest.model.ResultMessage"
          }
        },
        "data": {
          "type": "object",
          "description": "Returned results (might be an array or a single object)"
        }
      }
    },
    "no.mnemonic.services.pdns.spi.request.PDNSRequestRecord": {
      "type": "object",
      "required": [
        "answer",
        "query",
        "recordClass",
        "recordType",
        "tlp"
      ],
      "properties": {
        "lastSeen": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "Last seen, defaults to reception from agent. Accepts ISO-8601 timestamp string. (default now)"
        },
        "firstSeen": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "First time record was seen, usually is set by agent. Accepts ISO-8601 timestamp string. (default now)"
        },
        "times": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "Incident count (default 1)",
          "minimum": 1,
          "default": 1
        },
        "minTTLSec": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "Minimum Time to leave in seconds.",
          "minimum": 0
        },
        "maxTTLSec": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "Max Time to leave in seconds.",
          "minimum": 0
        },
        "query": {
          "type": "string",
          "position": 0,
          "description": "Querying address"
        },
        "answer": {
          "type": "string",
          "position": 0,
          "description": "Answering address"
        },
        "customer": {
          "type": "string",
          "position": 0,
          "description": "ID or shortname of customer"
        },
        "tlp": {
          "type": "string",
          "position": 0,
          "description": "Traffic Light Protocol",
          "enum": [
            "white",
            "green",
            "amber",
            "red"
          ]
        },
        "recordClass": {
          "type": "string",
          "position": 0,
          "description": "Record class type (default in)",
          "enum": [
            "in"
          ]
        },
        "recordType": {
          "type": "string",
          "position": 0,
          "description": "Record recordType",
          "enum": [
            "a",
            "aaaa",
            "cname",
            "dname",
            "mx",
            "naptr",
            "ns",
            "ptr",
            "rp",
            "soa",
            "srv",
            "txt"
          ]
        }
      },
      "description": "Request containing PDNS record information to be submitted"
    },
    "ResultStash": {
      "properties": {
        "responseCode": {
          "type": "integer",
          "format": "int32",
          "description": "Status code returned from API"
        },
        "limit": {
          "type": "integer",
          "format": "int64",
          "description": "Maximum number of returned results"
        },
        "offset": {
          "type": "integer",
          "format": "int64",
          "description": "Number of skipped results"
        },
        "count": {
          "type": "integer",
          "format": "int64",
          "description": "Number of available results on server"
        },
        "size": {
          "type": "integer",
          "format": "int64",
          "description": "Actual number of returned results"
        },
        "metaData": {
          "type": "object",
          "description": "Additional unstructured meta data associated with response"
        },
        "messages": {
          "type": "array",
          "description": "Contains messages returned from the API, usually error messages",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.argus.common.rest.model.ResultMessage"
          }
        },
        "data": {
          "type": "object",
          "description": "Returned results (might be an array or a single object)"
        }
      }
    },
    "no.mnemonic.jargus.model.CustomerInfo": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int64"
        },
        "name": {
          "type": "string"
        },
        "shortName": {
          "type": "string"
        },
        "domain": {
          "$ref": "#/definitions/no.mnemonic.jargus.model.DomainInfo"
        }
      }
    },
    "PDNSRequestRecord": {
      "type": "object",
      "required": [
        "answer",
        "query",
        "recordClass",
        "recordType",
        "tlp"
      ],
      "properties": {
        "lastSeen": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "Last seen, defaults to reception from agent. Accepts ISO-8601 timestamp string. (default now)"
        },
        "firstSeen": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "First time record was seen, usually is set by agent. Accepts ISO-8601 timestamp string. (default now)"
        },
        "times": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "Incident count (default 1)",
          "minimum": 1,
          "default": 1
        },
        "minTTLSec": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "Minimum Time to leave in seconds.",
          "minimum": 0
        },
        "maxTTLSec": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "Max Time to leave in seconds.",
          "minimum": 0
        },
        "query": {
          "type": "string",
          "position": 0,
          "description": "Querying address"
        },
        "answer": {
          "type": "string",
          "position": 0,
          "description": "Answering address"
        },
        "customer": {
          "type": "string",
          "position": 0,
          "description": "ID or shortname of customer"
        },
        "tlp": {
          "type": "string",
          "position": 0,
          "description": "Traffic Light Protocol",
          "enum": [
            "white",
            "green",
            "amber",
            "red"
          ]
        },
        "recordClass": {
          "type": "string",
          "position": 0,
          "description": "Record class type (default in)",
          "enum": [
            "in"
          ]
        },
        "recordType": {
          "type": "string",
          "position": 0,
          "description": "Record recordType",
          "enum": [
            "a",
            "aaaa",
            "cname",
            "dname",
            "mx",
            "naptr",
            "ns",
            "ptr",
            "rp",
            "soa",
            "srv",
            "txt"
          ]
        }
      },
      "description": "Request containing PDNS record information to be submitted"
    },
    "no.mnemonic.jargus.model.passivedns.PassiveDNSRecordV3": {
      "type": "object",
      "properties": {
        "createdTimestamp": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The timestamp when the record was created"
        },
        "lastUpdatedTimestamp": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The timestamp when the record was last updated"
        },
        "times": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The number of times this record has been seen"
        },
        "tlp": {
          "type": "string",
          "position": 0,
          "description": "The TLP of this record",
          "enum": [
            "white",
            "green",
            "amber",
            "red"
          ]
        },
        "query": {
          "type": "string",
          "position": 0,
          "description": "The query section this record represents"
        },
        "answer": {
          "type": "string",
          "position": 0,
          "description": "The answer section this record represents"
        },
        "minTtl": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The minimum time-to-live of this record"
        },
        "maxTtl": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The maximum time-to-live of this record"
        },
        "customer": {
          "position": 0,
          "description": "The customer that submitted this record",
          "$ref": "#/definitions/no.mnemonic.jargus.model.CustomerInfo"
        },
        "flags": {
          "type": "array",
          "position": 0,
          "description": "The flags for this record",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "enum": [
              "partialResult"
            ]
          }
        },
        "lastSeenTimestamp": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The timestamp when the record was last seen",
          "readOnly": true
        },
        "firstSeenTimestamp": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The timestamp when the record was first seen",
          "readOnly": true
        },
        "rrclass": {
          "type": "string",
          "position": 0,
          "description": "The class of this record",
          "readOnly": true,
          "enum": [
            "in"
          ]
        },
        "rrtype": {
          "type": "string",
          "position": 0,
          "description": "The type of this record",
          "readOnly": true,
          "enum": [
            "a",
            "aaaa",
            "cname",
            "dname",
            "mx",
            "naptr",
            "ns",
            "ptr",
            "rp",
            "soa",
            "srv",
            "txt"
          ]
        }
      },
      "description": "Response containing PDNS record information"
    },
    "no.mnemonic.jargus.model.DomainInfo": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int32"
        },
        "name": {
          "type": "string"
        }
      }
    },
    "ResultStash-no.mnemonic.services.pdns.spi.response.PDNSBulkSubmissionResponse-single": {
      "required": [
        "data"
      ],
      "properties": {
        "responseCode": {
          "type": "integer",
          "format": "int32",
          "description": "Status code returned from API"
        },
        "limit": {
          "type": "integer",
          "format": "int64",
          "description": "Maximum number of returned results"
        },
        "offset": {
          "type": "integer",
          "format": "int64",
          "description": "Number of skipped results"
        },
        "count": {
          "type": "integer",
          "format": "int64",
          "description": "Number of available results on server"
        },
        "size": {
          "type": "integer",
          "format": "int64",
          "description": "Actual number of returned results"
        },
        "metaData": {
          "type": "object",
          "description": "Additional unstructured meta data associated with response"
        },
        "messages": {
          "type": "array",
          "description": "Contains messages returned from the API, usually error messages",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.argus.common.rest.model.ResultMessage"
          }
        },
        "data": {
          "description": "Contains a single result",
          "$ref": "#/definitions/no.mnemonic.services.pdns.spi.response.PDNSBulkSubmissionResponse"
        }
      }
    },
    "ResultStash-no.mnemonic.jargus.model.passivedns.PassiveDNSRecordV3-list": {
      "required": [
        "data"
      ],
      "properties": {
        "responseCode": {
          "type": "integer",
          "format": "int32",
          "description": "Status code returned from API"
        },
        "limit": {
          "type": "integer",
          "format": "int64",
          "description": "Maximum number of returned results"
        },
        "offset": {
          "type": "integer",
          "format": "int64",
          "description": "Number of skipped results"
        },
        "count": {
          "type": "integer",
          "format": "int64",
          "description": "Number of available results on server"
        },
        "size": {
          "type": "integer",
          "format": "int64",
          "description": "Actual number of returned results"
        },
        "metaData": {
          "type": "object",
          "description": "Additional unstructured meta data associated with response"
        },
        "messages": {
          "type": "array",
          "description": "Contains messages returned from the API, usually error messages",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.argus.common.rest.model.ResultMessage"
          }
        },
        "data": {
          "type": "array",
          "description": "Contains an array of results",
          "items": {
            "$ref": "#/definitions/no.mnemonic.jargus.model.passivedns.PassiveDNSRecordV3"
          }
        }
      }
    },
    "DomainInfo": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int32"
        },
        "name": {
          "type": "string"
        }
      }
    },
    "no.mnemonic.services.pdns.spi.request.PDNSBulkSubmissionRequest": {
      "type": "object",
      "required": [
        "records"
      ],
      "properties": {
        "records": {
          "type": "array",
          "position": 0,
          "description": "PDNS records for submission.",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.pdns.spi.request.PDNSRequestRecord"
          },
          "maxItems": 2147483647,
          "minItems": 1
        },
        "ignoreOnFailed": {
          "type": "boolean",
          "position": 0,
          "description": "Set this value for successful response even failures occur while submitting. (default false)",
          "default": false
        }
      },
      "description": "Request to bulk submit PDNS records"
    },
    "PDNSExistsRecordsResponse": {
      "type": "object",
      "properties": {
        "exists": {
          "type": "boolean",
          "position": 0,
          "description": "Does records that match the query exist."
        }
      },
      "description": "Contains information about whether a record exists"
    },
    "PDNSBulkSubmissionResponse": {
      "type": "object",
      "properties": {
        "accepted": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Number of successfully submitted records."
        },
        "rejected": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Number of records that failed validation."
        },
        "errorInformationList": {
          "type": "array",
          "position": 0,
          "description": "Information regarding any records that rejected during validation.",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.pdns.spi.response.PDNSRecordErrorInformation"
          }
        }
      },
      "description": "Contains information on the bulk submit results"
    },
    "no.mnemonic.services.argus.common.rest.model.ResultMessage": {
      "type": "object",
      "properties": {
        "message": {
          "type": "string"
        },
        "messageTemplate": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": [
            "FIELD_ERROR",
            "ACTION_ERROR",
            "WARNING",
            "NOTIFICATION",
            "INFO"
          ]
        },
        "field": {
          "type": "string"
        },
        "parameter": {
          "type": "object"
        },
        "timestamp": {
          "type": "integer",
          "format": "int64"
        }
      }
    },
    "no.mnemonic.jargus.criteria.reputation.PassiveDNSSearchCriteriaV1": {
      "type": "object",
      "required": [
        "query"
      ],
      "properties": {
        "query": {
          "type": "string",
          "position": 0,
          "description": "Lookup query"
        },
        "aggregateResult": {
          "type": "boolean",
          "position": 0,
          "description": "Whether aggregate results (default true)"
        },
        "includeAnonymousResults": {
          "type": "boolean",
          "position": 0,
          "description": "Whether include anonymous results (default true)"
        },
        "rrClass": {
          "type": "array",
          "position": 0,
          "description": "Lookup with specified record classes",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "enum": [
              "in"
            ]
          }
        },
        "rrType": {
          "type": "array",
          "position": 0,
          "description": "Lookup with specified record types",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "enum": [
              "a",
              "aaaa",
              "cname",
              "dname",
              "mx",
              "naptr",
              "ns",
              "ptr",
              "rp",
              "soa",
              "srv",
              "txt"
            ]
          }
        },
        "customerID": {
          "type": "array",
          "position": 0,
          "description": "Lookup for specified customer IDs",
          "uniqueItems": true,
          "items": {
            "type": "integer",
            "format": "int64"
          }
        },
        "tlp": {
          "type": "array",
          "position": 0,
          "description": "Lookup with specified TLPs, public usage only TLP white allowed",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "enum": [
              "white",
              "green",
              "amber",
              "red"
            ]
          }
        },
        "limit": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Max number of results to be returned, default unset means default limit 25 will be used, 0 means unlimited"
        },
        "offset": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Number of results to be skipped first, default 0 (default 0)",
          "minimum": 0,
          "default": 0
        },
        "sortBy": {
          "type": "array",
          "position": 0,
          "description": "The field on which to sort the records",
          "items": {
            "type": "string",
            "enum": [
              "rrClass",
              "rrType",
              "customerID",
              "tlp",
              "count",
              "lastSeen",
              "firstSeen",
              "created",
              "-rrClass",
              "-rrType",
              "-customerID",
              "-tlp",
              "-count",
              "-lastSeen",
              "-firstSeen",
              "-created"
            ]
          }
        },
        "queryMatchStrategy": {
          "type": "string",
          "position": 0,
          "description": "Query match strategy, partial must be set to use the wildcard (default exact)",
          "enum": [
            "exact",
            "includeSubdomains"
          ]
        }
      },
      "description": "Request to search for PDNS records"
    },
    "ResultMessage": {
      "type": "object",
      "properties": {
        "message": {
          "type": "string"
        },
        "messageTemplate": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": [
            "FIELD_ERROR",
            "ACTION_ERROR",
            "WARNING",
            "NOTIFICATION",
            "INFO"
          ]
        },
        "field": {
          "type": "string"
        },
        "parameter": {
          "type": "object"
        },
        "timestamp": {
          "type": "integer",
          "format": "int64"
        }
      }
    },
    "no.mnemonic.services.pdns.spi.response.PDNSExistsRecordsResponse": {
      "type": "object",
      "properties": {
        "exists": {
          "type": "boolean",
          "position": 0,
          "description": "Does records that match the query exist."
        }
      },
      "description": "Contains information about whether a record exists"
    },
    "no.mnemonic.services.pdns.spi.response.PDNSRecordErrorInformation": {
      "type": "object",
      "properties": {
        "submissionIndex": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Index of the submission as it appears in the submission request."
        },
        "errorMessages": {
          "type": "array",
          "position": 0,
          "description": "String message of error cause.",
          "items": {
            "type": "string"
          }
        }
      },
      "description": "Contains error information from a bulk submit request"
    },
    "PassiveDNSRecordV3": {
      "type": "object",
      "properties": {
        "createdTimestamp": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The timestamp when the record was created"
        },
        "lastUpdatedTimestamp": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The timestamp when the record was last updated"
        },
        "times": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The number of times this record has been seen"
        },
        "tlp": {
          "type": "string",
          "position": 0,
          "description": "The TLP of this record",
          "enum": [
            "white",
            "green",
            "amber",
            "red"
          ]
        },
        "query": {
          "type": "string",
          "position": 0,
          "description": "The query section this record represents"
        },
        "answer": {
          "type": "string",
          "position": 0,
          "description": "The answer section this record represents"
        },
        "minTtl": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The minimum time-to-live of this record"
        },
        "maxTtl": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The maximum time-to-live of this record"
        },
        "customer": {
          "position": 0,
          "description": "The customer that submitted this record",
          "$ref": "#/definitions/no.mnemonic.jargus.model.CustomerInfo"
        },
        "flags": {
          "type": "array",
          "position": 0,
          "description": "The flags for this record",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "enum": [
              "partialResult"
            ]
          }
        },
        "lastSeenTimestamp": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The timestamp when the record was last seen",
          "readOnly": true
        },
        "firstSeenTimestamp": {
          "type": "integer",
          "format": "int64",
          "position": 0,
          "description": "The timestamp when the record was first seen",
          "readOnly": true
        },
        "rrclass": {
          "type": "string",
          "position": 0,
          "description": "The class of this record",
          "readOnly": true,
          "enum": [
            "in"
          ]
        },
        "rrtype": {
          "type": "string",
          "position": 0,
          "description": "The type of this record",
          "readOnly": true,
          "enum": [
            "a",
            "aaaa",
            "cname",
            "dname",
            "mx",
            "naptr",
            "ns",
            "ptr",
            "rp",
            "soa",
            "srv",
            "txt"
          ]
        }
      },
      "description": "Response containing PDNS record information"
    },
    "ResultStash-no.mnemonic.services.pdns.spi.response.PDNSExistsRecordsResponse-single": {
      "required": [
        "data"
      ],
      "properties": {
        "responseCode": {
          "type": "integer",
          "format": "int32",
          "description": "Status code returned from API"
        },
        "limit": {
          "type": "integer",
          "format": "int64",
          "description": "Maximum number of returned results"
        },
        "offset": {
          "type": "integer",
          "format": "int64",
          "description": "Number of skipped results"
        },
        "count": {
          "type": "integer",
          "format": "int64",
          "description": "Number of available results on server"
        },
        "size": {
          "type": "integer",
          "format": "int64",
          "description": "Actual number of returned results"
        },
        "metaData": {
          "type": "object",
          "description": "Additional unstructured meta data associated with response"
        },
        "messages": {
          "type": "array",
          "description": "Contains messages returned from the API, usually error messages",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.argus.common.rest.model.ResultMessage"
          }
        },
        "data": {
          "description": "Contains a single result",
          "$ref": "#/definitions/no.mnemonic.services.pdns.spi.response.PDNSExistsRecordsResponse"
        }
      }
    },
    "PDNSRecordErrorInformation": {
      "type": "object",
      "properties": {
        "submissionIndex": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Index of the submission as it appears in the submission request."
        },
        "errorMessages": {
          "type": "array",
          "position": 0,
          "description": "String message of error cause.",
          "items": {
            "type": "string"
          }
        }
      },
      "description": "Contains error information from a bulk submit request"
    },
    "no.mnemonic.services.pdns.spi.response.PDNSBulkSubmissionResponse": {
      "type": "object",
      "properties": {
        "accepted": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Number of successfully submitted records."
        },
        "rejected": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Number of records that failed validation."
        },
        "errorInformationList": {
          "type": "array",
          "position": 0,
          "description": "Information regarding any records that rejected during validation.",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.pdns.spi.response.PDNSRecordErrorInformation"
          }
        }
      },
      "description": "Contains information on the bulk submit results"
    },
    "PDNSBulkSubmissionRequest": {
      "type": "object",
      "required": [
        "records"
      ],
      "properties": {
        "records": {
          "type": "array",
          "position": 0,
          "description": "PDNS records for submission.",
          "items": {
            "$ref": "#/definitions/no.mnemonic.services.pdns.spi.request.PDNSRequestRecord"
          },
          "maxItems": 2147483647,
          "minItems": 1
        },
        "ignoreOnFailed": {
          "type": "boolean",
          "position": 0,
          "description": "Set this value for successful response even failures occur while submitting. (default false)",
          "default": false
        }
      },
      "description": "Request to bulk submit PDNS records"
    },
    "CustomerInfo": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int64"
        },
        "name": {
          "type": "string"
        },
        "shortName": {
          "type": "string"
        },
        "domain": {
          "$ref": "#/definitions/no.mnemonic.jargus.model.DomainInfo"
        }
      }
    },
    "PassiveDNSSearchCriteriaV1": {
      "type": "object",
      "required": [
        "query"
      ],
      "properties": {
        "query": {
          "type": "string",
          "position": 0,
          "description": "Lookup query"
        },
        "aggregateResult": {
          "type": "boolean",
          "position": 0,
          "description": "Whether aggregate results (default true)"
        },
        "includeAnonymousResults": {
          "type": "boolean",
          "position": 0,
          "description": "Whether include anonymous results (default true)"
        },
        "rrClass": {
          "type": "array",
          "position": 0,
          "description": "Lookup with specified record classes",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "enum": [
              "in"
            ]
          }
        },
        "rrType": {
          "type": "array",
          "position": 0,
          "description": "Lookup with specified record types",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "enum": [
              "a",
              "aaaa",
              "cname",
              "dname",
              "mx",
              "naptr",
              "ns",
              "ptr",
              "rp",
              "soa",
              "srv",
              "txt"
            ]
          }
        },
        "customerID": {
          "type": "array",
          "position": 0,
          "description": "Lookup for specified customer IDs",
          "uniqueItems": true,
          "items": {
            "type": "integer",
            "format": "int64"
          }
        },
        "tlp": {
          "type": "array",
          "position": 0,
          "description": "Lookup with specified TLPs, public usage only TLP white allowed",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "enum": [
              "white",
              "green",
              "amber",
              "red"
            ]
          }
        },
        "limit": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Max number of results to be returned, default unset means default limit 25 will be used, 0 means unlimited"
        },
        "offset": {
          "type": "integer",
          "format": "int32",
          "position": 0,
          "description": "Number of results to be skipped first, default 0 (default 0)",
          "minimum": 0,
          "default": 0
        },
        "sortBy": {
          "type": "array",
          "position": 0,
          "description": "The field on which to sort the records",
          "items": {
            "type": "string",
            "enum": [
              "rrClass",
              "rrType",
              "customerID",
              "tlp",
              "count",
              "lastSeen",
              "firstSeen",
              "created",
              "-rrClass",
              "-rrType",
              "-customerID",
              "-tlp",
              "-count",
              "-lastSeen",
              "-firstSeen",
              "-created"
            ]
          }
        },
        "queryMatchStrategy": {
          "type": "string",
          "position": 0,
          "description": "Query match strategy, partial must be set to use the wildcard (default exact)",
          "enum": [
            "exact",
            "includeSubdomains"
          ]
        }
      },
      "description": "Request to search for PDNS records"
    }
  }
}