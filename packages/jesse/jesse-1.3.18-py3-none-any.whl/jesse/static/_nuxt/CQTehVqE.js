import{u as w,_ as W}from"./RzscXvxS.js";import{h as z,r as g,j as k,aw as F,bj as K,k as f,b8 as $,bk as T,o as E,c as D,x as q,E as A,i as G,l as J,m as I,bl as P,b as p,d as s,w as d,D as y,L,F as Q,B as X,G as Y,M as B,bm as Z,a7 as ee,t as te,e as b,q as oe,U as ae,y as ne,bn as se}from"./CzO8hhlE.js";import{u as le}from"./JSpMHAn8.js";const ie=z({__name:"MonacoEditor.client",props:{lang:{default:()=>"plaintext"},options:{default:()=>({})},modelValue:{default:()=>""}},emits:["update:modelValue","load"],setup(V,{expose:c,emit:l}){const t=V,u=l,S=g(!0),v=k(()=>t.lang||t.options.language),i=F(),r=g(),a=K(),x={automaticLayout:!0};let e,n;return f(()=>t.modelValue,()=>{(e==null?void 0:e.getValue())!==t.modelValue&&(e==null||e.setValue(t.modelValue))}),f(()=>t.lang,()=>{n&&n.dispose(),n=a.editor.createModel(t.modelValue,v.value),e==null||e.setModel(n)}),f(()=>t.options,()=>{e==null||e.updateOptions($(t.options,x))}),f(r,(C,_)=>{!r.value||_||(e=a.editor.create(r.value,$(t.options,x)),n=a.editor.createModel(t.modelValue,v.value),i.value=e,e.layout(),e.setModel(n),e.onDidChangeModelContent(()=>{u("update:modelValue",e.getValue())}),S.value=!1,u("load",e))}),c({$editor:i}),T(()=>{e==null||e.dispose(),n==null||n.dispose()}),(C,_)=>(E(),D("div",{ref_key:"editorElement",ref:r},[S.value?q(C.$slots,"default",{key:0}):A("",!0)],512))}}),re=se(ie),de={class:"grid items-start lg:grid-cols-5"},ce={class:"grid grid-cols-1 lg:col-span-4 bg-backdrop dark:bg-backdrop-dark"},ue={class:"h-10 flex items-center justify-between px-4"},me={class:"font-semibold"},pe={class:"flex items-center select-none"},ge={class:"overflow-hidden border-l border-t dark:border-gray-600"},he=z({__name:"[name]",setup(V){const c=g(!1),l=k(()=>X().params.name),t=g(""),u=g(""),S=G(),v=k(()=>S.value==="light"?"vs-light":"vs-dark"),i=g();le({title:`${l.value} - Jesse`}),f(v,o=>{i.value.$editor.updateOptions({theme:o})}),J(async()=>{setTimeout(async()=>{t.value=await w().getStrategy(l.value),u.value=t.value,i.value.$editor.updateOptions({theme:v.value})},200),window.addEventListener("keydown",_)}),I(()=>{window.removeEventListener("keydown",_)});const r=k(()=>t.value!==u.value),a=k(()=>Y().settings.editor),x={automaticLayout:!0,minimap:{enabled:a.value.minimap},fontSize:a.value.fontSize,padding:{top:16,bottom:16},cursorStyle:a.value.cursorStyle,cursorWidth:a.value.cursorWidth,lineHeight:a.value.lineHeight,cursorBlinking:a.value.cursorBlinking,renderLineHighlight:a.value.renderLineHighlight};f(a,o=>{i.value.$editor.updateOptions({minimap:{enabled:o.minimap},fontSize:o.fontSize,cursorStyle:o.cursorStyle,cursorWidth:o.cursorWidth,lineHeight:o.lineHeight,cursorBlinking:o.cursorBlinking,renderLineHighlight:o.renderLineHighlight})},{deep:!0});function e(){navigator.clipboard.writeText(t.value),B("success","Code copied to clipboard")}async function n(){if(r.value){if(t.value===""){B("error","Code cannot be empty");return}await w().saveStrategy(l.value,t.value),u.value=t.value}}const C=P.debounce(async()=>{await n()},300);function _(o){o.key==="s"&&(navigator.platform.match("Mac")?o.metaKey:o.ctrlKey)&&(o.preventDefault(),C())}function H(){i.value.$editor.trigger("source","actions.find",{})}function O(){w().deleteStrategy(l.value),ae().push("/strategies")}return(o,m)=>{const R=W,h=ne,U=re,N=Z,j=ee;return E(),D(Q,null,[p("section",de,[s(R),p("div",ce,[s(N,null,{default:d(()=>[p("div",ue,[p("h2",me,te(y(l)),1),p("div",pe,[s(h,{size:"xs",icon:"i-heroicons-trash",color:"gray",variant:"ghost",class:"ml-2",onClick:m[0]||(m[0]=M=>c.value=!0)},{default:d(()=>[b(" Delete ")]),_:1}),s(h,{size:"xs",icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",class:"ml-2",onClick:e},{default:d(()=>[b(" Copy ")]),_:1}),s(h,{size:"xs",icon:"i-heroicons-magnifying-glass",class:"ml-2",color:"gray",variant:"ghost",onClick:H},{default:d(()=>[b(" Find ")]),_:1}),s(h,{size:"xs",icon:"i-heroicons-check",class:"ml-2",color:"teal",variant:"ghost",disabled:!y(r),onClick:n},{default:d(()=>[b(" Save ")]),_:1},8,["disabled"])])]),p("div",ge,[s(U,{ref_key:"editorRef",ref:i,modelValue:y(t),"onUpdate:modelValue":m[1]||(m[1]=M=>L(t)?t.value=M:null),lang:"python",options:x,style:oe({height:"calc(100vh - 4rem - 4px - 2.5rem)"})},{default:d(()=>[b(" Loading editor... ")]),_:1},8,["modelValue","style"])])]),_:1})])]),s(j,{modelValue:y(c),"onUpdate:modelValue":m[2]||(m[2]=M=>L(c)?c.value=M:null),title:"Delete strategy",description:`Are you sure you want to delete the strategy '${y(l)}'?`,type:"info"},{default:d(()=>[s(h,{variant:"solid",color:"red",class:"flex justify-center",label:"Delete",onClick:O})]),_:1},8,["modelValue","description"])],64)}}});export{he as default};
